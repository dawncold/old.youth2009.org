
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Trade Off</title>
	<meta name="author" content="dawncold">

	
	<meta name="description" content="本来打算针对上传的图片进行验证，不过发现在form中加入enctype属性之后原本针对FileField的验证就不管用了，field.data始终是None，但是去掉enctype属性就ok，不过去掉之后不能上传文件了，所以最终只好去掉验证，在request中进行验证。 &hellip;">
	

	<link href="/atom.xml" rel="alternate" title="Trade Off" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
	
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-8650400-5']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


	
</head>

<body>
	<header id="header" class="inner"><nav><ul>
  <li><a href="/">Home</a></li>
  <li><a href="/about">About</li>
  <li><a href="/blog/archives">Archives</a></li>
</ul></nav>
</header>
	<div id="content" class="inner">


	<article class="post"><header>
  
  <h1 class="title"><a href="/blog/2012/07/05/validation-of-filefield-in-wtforms/">WTForms中的FileField验证</a></h1>
  
  








	
		<time datetime="2012-07-05T20:17:00+08:00">
			<span class="day"> 5</span><span class="month">Jul</span>
		</time>
	

</header>
<div class="entry-content">
  
    <p>本来打算针对上传的图片进行验证，不过发现在form中加入enctype属性之后原本针对FileField的验证就不管用了，field.data始终是None，但是去掉enctype属性就ok，不过去掉之后不能上传文件了，所以最终只好去掉验证，在request中进行验证。</p>

<p>比如我是这样验证没有选择图片的：</p>

<pre class="prettyprint linenums bush:python" lang="python">form = xxxForm(request.form)
f = request.files["image"]
if len(f.filename) == 0:
 form.image.errors = ValidationError(u"need a pic file!!!")
 return render_template("xxx", form = form)
......</pre>


<p>如果有不同的见解请告诉我哦！</p>

  
  
  <footer class="meta">
    



	<div class="tags"><a class='category' href='/blog/categories/filefield/'>filefield</a><a class='category' href='/blog/categories/flask/'>flask</a><a class='category' href='/blog/categories/wtforms/'>wtforms</a><a class='category' href='/blog/categories/ji-zhu/'>技术</a></div>

    
  </footer>
  
</div>
</article>


	<article class="post"><header>
  
  <h1 class="title"><a href="/blog/2012/07/02/deploy-flask-on-my-vps/">VPS中部署了Flask框架</a></h1>
  
  








	
		<time datetime="2012-07-02T20:46:00+08:00">
			<span class="day"> 2</span><span class="month">Jul</span>
		</time>
	

</header>
<div class="entry-content">
  
    <p>一开始我也是用web.py的，不料接受不了它的session处理，然后离开，Django这种庞大的东西我是没精力去研究了，当然开始也伴随激情看过文档，没坚持下去，后来和强锅一起找了不少框架做东西，我实践性比较强，就找到了Flask，感觉还挺好用的，做了一个todo，有兴趣可以看：<a href="http://todo.wodeyitian.com%E3%80%82">http://todo.wodeyitian.com%E3%80%82</a></p>

<p>原先部署在dotcloud上，刚刚在自己的VPS上完成了nginx+uwsgi+flask的集成，当然还是没有废弃掉php，为了好几个博客嘛～</p>

<p>总的来说就是用virtualenv来创建各个app的目录，在里面安装需要的环境（flask、mysql-python、beautifulsoup4等等吧），nginx的配置大概如下：</p>

<pre class="prettyprint linenums bush:bash" lang="bash">server {
     listen       80;
     server_name  todo.wodeyitian.com;
     location / {
               include uwsgi_params;
               uwsgi_pass 127.0.0.1:9090;
               uwsgi_param UWSGI_PYHOME /home/wwwroot/python_app_todo;
               uwsgi_param UWSGI_CHDIR /home/wwwroot/python_app_todo/app_dir;
               uwsgi_param UWSGI_SCRIPT todoApp:app;
     }
}</pre>


<p>UWSGI_PYHOME是app的主目录，下面的CHDIR是app中py文件所在的目录，这个可以自己设置，下面的SCRIPT是入口脚本模块名和变量名，模块就是文件名喽，变量一般在flask都是用app作为整个网站的入口变量，写过python基本都能明白这个。</p>

<p>安装好uwsgi后可以配置开启：</p>

<pre class="prettyprint linenums bush:bash" lang="bash">uwsgi -s :9090 -M -p 4 -t 30 --limit-as 128 -R 10000 -d uwsgi.log --vhost</pre>




<p><p style="text-align: left;">使用9090端口监听，-M开启主控线程，-p 4是开启4个线程，-t 30是超过30秒不响应丢弃，limit-as 128是限制128Mb的内存占用，-R 10000是超过10000的请求就自动<span style="font-family: Verdana, sans-serif, 宋体;"><span style="line-height: 24px;">respawn（似乎是自动复制？重启？之类的），-d是日志，&mdash;vhost这个可以让多个app共用一个uwsgi，很好用的！</span></span></p>

  
  
  <footer class="meta">
    



	<div class="tags"><a class='category' href='/blog/categories/flask/'>flask</a><a class='category' href='/blog/categories/nginx/'>nginx</a><a class='category' href='/blog/categories/python/'>python</a><a class='category' href='/blog/categories/uwsgi/'>uwsgi</a><a class='category' href='/blog/categories/vps/'>vps</a><a class='category' href='/blog/categories/ji-zhu/'>技术</a></div>

    
  </footer>
  
</div>
</article>


	<article class="post"><header>
  
  <h1 class="title"><a href="/blog/2012/07/01/manage-xp-in-virtualbox/">管理VirtualBox中的XP</a></h1>
  
  








	
		<time datetime="2012-07-01T23:16:00+08:00">
			<span class="day"> 1</span><span class="month">Jul</span>
		</time>
	

</header>
<div class="entry-content">
  
    <p>今天打算好好整理一下XP系统，本想在几个虚拟机软件中选一个出来的，大家都说ParllelsDesktop不错，但我一直在用VirtualBox，主要原因是VB这个免费，其实买PD的中文版也就是199元，很容易买，如果真的性能优秀我就决定入一个（哈哈，又在炫耀了！）</p>

<p>中途我卸载了xp中的ie7，打算装ie8呢，结果重启后发现找不到iertutil.dll，随便下载了一个版本不对的放到了system32中，结果更是不能用了，好在家里还有台xp电脑，拿来了一个正确的版本（大小1.9Mb左右，而且我发现系统中的dllcache中会保留以前用得dll，要不怎么叫cache呢），用老毛桃PE删掉原来的替换了新的dll，进入系统装了ie8，这算是告一段落。</p>

<p>又安装了好几个小时的VS2010 Web Developer Express，最后说磁盘空间不够了。。。扩充磁盘空间还算是好用吧：</p>

<pre class="prettyprint linenums bush:bash" lang="bash">VBoxManage modifyhd PATH_TO_VDI_FILE --resize NEW_SIZE</pre>


<p>原本10G，现在改了20G，进入系统后原系统分区并不会增加，只是多了一块空闲的空间，然后又用老毛桃PE中的软件（PM）扩种分区。</p>

  
  
  <footer class="meta">
    



	<div class="tags"><a class='category' href='/blog/categories/macxi-tong-zhong-de-shi-yong-ji-qiao/'>Mac系统中的使用技巧</a><a class='category' href='/blog/categories/virtualbox/'>virtualbox</a><a class='category' href='/blog/categories/vs2010/'>vs2010</a><a class='category' href='/blog/categories/windows-xp/'>windows xp</a><a class='category' href='/blog/categories/ji-zhu/'>技术</a></div>

    
  </footer>
  
</div>
</article>


	<article class="post"><header>
  
  <h1 class="title"><a href="/blog/2012/06/25/property-not-found-in-el-expression/">关于EL表达式中的Property &#8216;Name&#8217; Not Found on Type java.lang.String错误</a></h1>
  
  








	
		<time datetime="2012-06-25T09:00:00+08:00">
			<span class="day">25</span><span class="month">Jun</span>
		</time>
	

</header>
<div class="entry-content">
  
    <p>好了，我直接说自己遇到的情况，就是上面这行提示，找不到name属性，在java.lang.String中，仔细看哦，这句话的意思是你在一个String类型中找name属性，当然不会找到了！！！因为本来String中就没有name属性。</p>

<p>初衷是一个list中，里面的每个元素都有name属性，但是经过JPQL查询后的list给了jsp页面，在输出的时候就得到了这样的提示。实际上我是JPQL写错了，我直接得到了具体的值，所以是String类型的一个list，应该用JPQL得到实体，这样就OK了。</p>

<p>比如：得到的是Student实体，可以用里面的name属性。</p>

<pre class="prettyprint linenums bush:bash" lang="bash">SELECT s FROM Student s, School sc WHERE sc.city = '北京' AND s.school.id = sc.id AND s.name LIKE '张%'</pre>


<p>但是：得到的就是具体的name了，再用name属性就会出现上面的错误</p>

<pre class="prettyprint linenums bush:bash" lang="bash">SELECT s.name FROM Student s, School sc WHERE sc.city = '北京' AND s.school.id = sc.id AND s.name LIKE '张%'</pre>


<p>这种错误很难搞的！！！</p>

  
  
  <footer class="meta">
    



	<div class="tags"><a class='category' href='/blog/categories/el/'>el</a><a class='category' href='/blog/categories/jpql/'>jpql</a><a class='category' href='/blog/categories/jsp/'>jsp</a><a class='category' href='/blog/categories/ji-zhu/'>技术</a></div>

    
  </footer>
  
</div>
</article>


	<article class="post"><header>
  
  <h1 class="title"><a href="/blog/2012/06/18/it-is-better-to-config-two-shortkeys-for-switch-tags--in-eclipse/">Eclipse中最好配置上切换tabs的快捷键</a></h1>
  
  








	
		<time datetime="2012-06-18T08:01:00+08:00">
			<span class="day">18</span><span class="month">Jun</span>
		</time>
	

</header>
<div class="entry-content">
  
    <p>在Terminal中用Command+Shift+[和Command+Shift+]来切换tabs太爽了，很多Mac下的程序都默认支持了这样的切换方式，不过eclipse中默认没支持，非常可惜，硬用这样切换倒是也有效果，不过你用两次就知道这不是你想要的那种！！</p>

<p>于是配置快捷键，分别配置Privious Tag和Next Tag即可<img title="微笑" src="http://www.youth2009.org/usr/plugins/TinyMCE/tiny_mce/plugins/emotions/img/smiley-smile.gif" alt="微笑" border="0"></p>

  
  
  <footer class="meta">
    



	<div class="tags"><a class='category' href='/blog/categories/macxi-tong-zhong-de-shi-yong-ji-qiao/'>Mac系统中的使用技巧</a><a class='category' href='/blog/categories/eclipse/'>eclipse</a><a class='category' href='/blog/categories/ji-zhu/'>技术</a></div>

    
  </footer>
  
</div>
</article>


	<article class="post"><header>
  
  <h1 class="title"><a href="/blog/2012/06/13/config-vi-simply/">简单配置一下vi</a></h1>
  
  








	
		<time datetime="2012-06-13T22:26:00+08:00">
			<span class="day">13</span><span class="month">Jun</span>
		</time>
	

</header>
<div class="entry-content">
  
    <p>看到vpsee上的vi打开网页啥的都能自动高亮，原本一直用着纯文本方式vi的我动心了，搜索了一点点配置，加入这些配置到~/vimrc这样的文件中后，打开vi就能自动加载配置。</p>

<p>下面的分别是：显示行号、自动缩进、开启语法高亮、编辑背景为暗色调、开启粘贴（传说复制过来的代码不会乱掉）</p>

<pre class="prettyprint linenums bush:bash" lang="bash">set number
set autoindent
syntax enable
set background=dark
set paste</pre>


<p>vim是和emace同样重量级的编辑器，如果你是一个Linux控你肯定明白那句话，vi是vim的前身（允许我这样描述吧），所以配置都是这些编辑器的看家本领，这几条简单配置仅仅是个入门，还可以根据自己的需要添加修改<img title="微笑" src="http://www.youth2009.org/usr/plugins/TinyMCE/tiny_mce/plugins/emotions/img/smiley-smile.gif" alt="微笑" border="0"></p>

  
  
  <footer class="meta">
    



	<div class="tags"><a class='category' href='/blog/categories/vi/'>vi</a><a class='category' href='/blog/categories/vps/'>vps</a><a class='category' href='/blog/categories/ji-zhu/'>技术</a></div>

    
  </footer>
  
</div>
</article>


	<article class="post"><header>
  
  <h1 class="title"><a href="/blog/2012/06/13/migrate-to-new-vps/">迁移到了新VPS上</a></h1>
  
  








	
		<time datetime="2012-06-13T16:22:00+08:00">
			<span class="day">13</span><span class="month">Jun</span>
		</time>
	

</header>
<div class="entry-content">
  
    <p>前面几篇log中有提及，实在无法忍受yardvps的服务了，一开始真的不错，但现在越来越不行了，可能这就是标志着一个vps提供商由正规经营到超卖的转变。上次停机超过了24个小时，发了ticket过去问，结果是说我被ddos了，就自动把我从网络中断开了，真有意思的说法，反正已经无法考证其真实性了，我只好选择离开。</p>

<p>新的VPS比以前贵，大约是每月10刀（原来的512Mb的YardVPS是7.59刀），但新的vps性能很好，网络也很好很快，希望能一直用下去，贵点就贵点呗，比起神器Linode便宜了不少。</p>

<p>这个技术blog是最后迁移过来的了，原先有几个php写得东西光是把数据库保存下来了，就不再挂出来让大家访问了吧，我猜也没几个用得，留着数据库做个纪念<img title="微笑" src="http://www.youth2009.org/usr/plugins/TinyMCE/tiny_mce/plugins/emotions/img/smiley-smile.gif" alt="微笑" border="0"></p>

  
  
  <footer class="meta">
    



	<div class="tags"><a class='category' href='/blog/categories/vps/'>vps</a><a class='category' href='/blog/categories/ji-zhu/'>技术</a></div>

    
  </footer>
  
</div>
</article>


	<article class="post"><header>
  
  <h1 class="title"><a href="/blog/2012/06/11/lib-javahl-for-svn-on-mac/">Svn的javahl库</a></h1>
  
  








	
		<time datetime="2012-06-11T10:17:00+08:00">
			<span class="day">11</span><span class="month">Jun</span>
		</time>
	

</header>
<div class="entry-content">
  
    <p>今天基本完成了LoveSMS，想checkout一下jdrcom来看看，所以就安装上了svn for eclipse，然后在导入的时候提示缺少javahl库，去了官方查看了一下，说是对于Mac用户，只需要下载他们的bin文件就能解决，我一看才给到1.6.5的版本，而我自己用brew都装到了1.7.5，而且svn插件用的是1.8.x，需要1.7+的svn支持才行，所以就自己重新安装了svn：</p>

<pre class="prettyprint linenums bush:bash" lang="bash">brew install subversion --universal --java</pre>


<p>这句是关键哦，当然你得先uninstall已经安装的svn才行。加了java开关就可以告诉svn需要java IDE的库，编译的完成后会继续编译javahl～</p>

<p>会有这样的提示哦：</p>

<pre class="prettyprint linenums bush:bash" lang="bash">To use Java bindings with various Java IDEs, you might need a universal build:
 brew install subversion --universal --java
==&gt; ./configure --disable-debug --prefix=/usr/local/Cellar/subversion/1.7.5 --with-ssl --with-zlib=/usr --with-sqlite=/usr/local --disable-neon-version-chec
==&gt; make
==&gt; make install
==&gt; make javahl
==&gt; make install-javahl
==&gt; Caveats
You may need to link the Java bindings into the Java Extensions folder:
 sudo mkdir -p /Library/Java/Extensions
 sudo ln -s /usr/local/lib/libsvnjavahl-1.dylib /Library/Java/Extensions/libsvnjavahl-1.dylib</pre>


<p>自己加入后面的链接就ok了！</p>

  
  
  <footer class="meta">
    



	<div class="tags"><a class='category' href='/blog/categories/macxi-tong-zhong-de-shi-yong-ji-qiao/'>Mac系统中的使用技巧</a><a class='category' href='/blog/categories/java/'>java</a><a class='category' href='/blog/categories/javahl/'>javahl</a><a class='category' href='/blog/categories/svn/'>svn</a><a class='category' href='/blog/categories/ji-zhu/'>技术</a></div>

    
  </footer>
  
</div>
</article>


	<article class="post"><header>
  
  <h1 class="title"><a href="/blog/2012/06/08/solved-sudo-unable-to-resolve-host/">Sudo 出现unable to Resolve Host 解决方法</a></h1>
  
  








	
		<time datetime="2012-06-08T16:23:00+08:00">
			<span class="day"> 8</span><span class="month">Jun</span>
		</time>
	

</header>
<div class="entry-content">
  
    <p>执行一句sudo xxx会发现：（HOSTNAME就是你的hostname了）</p>

<pre class="prettyprint linenums bush:bash" lang="bash">sudo ：unable to resolve host HOSTNAME</pre>


<p>这样修复：(编辑/etc/hosts，修改127.0.0.1那行，把你的hostname加入到那行的最后即可)</p>

<pre class="prettyprint linenums bush:bash" lang="bash">127.0.0.1               localhost.localdomain localhost HOSTNAME</pre>


<p>希望vpsee的admin能在iso中修复这个问题</p>

  
  
  <footer class="meta">
    



	<div class="tags"><a class='category' href='/blog/categories/sudo/'>sudo</a><a class='category' href='/blog/categories/vps/'>vps</a><a class='category' href='/blog/categories/ji-zhu/'>技术</a></div>

    
  </footer>
  
</div>
</article>


	<article class="post"><header>
  
  <h1 class="title"><a href="/blog/2012/06/08/solved-set-lc_ctype-to-default-locale-no-such-file-or-directory/">解决Cannot Set LC_CTYPE to Default Locale: No Such File or Directory问题</a></h1>
  
  








	
		<time datetime="2012-06-08T16:20:00+08:00">
			<span class="day"> 8</span><span class="month">Jun</span>
		</time>
	

</header>
<div class="entry-content">
  
    <p>刚拿到vps，打算更新一些软件，发现有些warning挺讨厌的，于是就想根除他们！！他们一般是这样的：</p>

<pre class="prettyprint linenums bush:bash" lang="bash">locale: Cannot set LC_CTYPE to default locale: No such file or directory
locale: Cannot set LC_MESSAGES to default locale: No such file or directory
locale: Cannot set LC_ALL to default locale: No such file or directory</pre>


<p>我看到我的LANG被设定为zh_CN.utf8，虽然我们是国人，但这个语言习惯不能代表我们的爱国情怀吧，我就改为en_US.utf8了：</p>

<pre class="prettyprint linenums bush:bash" lang="bash">sudo touch /etc/default/locale
vi /etc/default/locale</pre>


<p>加入：</p>

<pre class="prettyprint linenums bush:bash" lang="bash">LANG="en_US.UTF-8"
LANGUAGE="en_US:en"</pre>


<p>再执行一下locale就发现问题不见了。</p>

<p>希望vpsee的admin能在iso中修正这个事儿～</p>

  
  
  <footer class="meta">
    



	<div class="tags"><a class='category' href='/blog/categories/locale/'>locale</a><a class='category' href='/blog/categories/vps/'>vps</a><a class='category' href='/blog/categories/ji-zhu/'>技术</a></div>

    
  </footer>
  
</div>
</article>


<nav id="pagenavi">
	<a href="/blog/page/4/" class="prev alignleft">Prev</a>
	<a href="/blog/page/6/" class="next alignright">Next</a>
 <div class="clearfix"></div>
</nav>
</div>
	<footer id="footer" class="inner"><div class="social alignright">
	
	
	
	
	
	<a class="rss" href="/atom.xml" title="RSS">RSS</a>
</div>
<p>&copy; 2013 dawncold</p>
<div class="clearfix"></div></footer>
	<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
	(function($){
		$('.entry-content').each(function(i){
			var _i = i;
			$(this).find('img').each(function(){
				var alt = $(this).attr('alt');

				if (alt == '' || typeof alt == 'undefined'){
					$(this).wrap('<a href="'+$(this).attr('src')+'" class="fancybox" rel="gallery'+_i+'" />');
				} else {
					$(this).after('<span class="caption">'+alt+'</span>').wrap('<a href="'+$(this).attr('src')+'" class="fancybox" title="'+alt+'" rel="gallery'+_i+'" />');
				}
			});
		});
		$('.fancybox').fancybox();
	})(jQuery);
</script>
<div id="phasebeam">
	<canvas></canvas>
	<canvas></canvas>
	<canvas></canvas>
</div>
<script src="/javascripts/phasebeam.js"></script>


<script type="text/javascript">
      var disqus_shortname = 'dawncoldtechblog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



</body>
</html>
<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: crontab | dawncold's tech blog]]></title>
  <link href="http://www.youth2009.org/blog/categories/crontab/atom.xml" rel="self"/>
  <link href="http://www.youth2009.org/"/>
  <updated>2013-02-20T00:21:09+08:00</updated>
  <id>http://www.youth2009.org/</id>
  <author>
    <name><![CDATA[dawncold]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[用python备份mysql]]></title>
    <link href="http://www.youth2009.org/blog/2012/04/27/backup-mysql-databases-using-python/"/>
    <updated>2012-04-27T20:44:00+08:00</updated>
    <id>http://www.youth2009.org/blog/2012/04/27/backup-mysql-databases-using-python</id>
    <content type="html"><![CDATA[<pre><code>        &lt;p&gt;备份数据库的重要性不想多说了。&lt;/p&gt;
</code></pre>

<br /><pre class="prettyprint linenums bush:python" lang="python">#! /usr/bin/env python


<h1>coding: utf-8</h1>

<p>import os
import sys
from datetime import *
import time</p>

<h1>mysql's path</h1>

<p>mysql_path = '/usr/local/mysql/bin/'</p>

<h1>edit this if your mysql username and password is not like this:</h1>

<p>mysql_username = 'root'
mysql_password = 'xxxxxx'</p>

<h1>backup path</h1>

<p>backup_path = 'mysqlbackup/'</p>

<p>def validate_backup_path():</p>

<pre><code>if os.path.exists(backup_path) == False:
    print "I create a directory here: %s " % backup_path
    os.mkdir(backup_path)
</code></pre>

<p>def backup_all_databases():</p>

<pre><code>filename = "all_%s.sql" % (datetime.utcfromtimestamp(time.time()))
os.system("%smysqldump -u%s -p%s --all-databases &amp;gt; '%s%s'" % (mysql_path, mysql_username, mysql_password, backup_path, filename))
</code></pre>

<p>if <strong>name</strong> == "<strong>main</strong>":</p>

<pre><code>validate_backup_path()
backup_all_databases()
print "finish!!!"&lt;/pre&gt;
</code></pre>

<br /><p>这个是修改了一次的备份脚本，本来是分数据库备份的，无奈制定了分数据库备份需要输入密码，这就不容易加入cron来自动完成了，不过听说在my.cnf中加入mysqldump的设置可以避免输入账号密码，这也算是一个办法吧，不过还是本着简化的思想，只导出所有数据库出来就好，配合着上一篇的dropbox自动备份，这样VPS的灾备就稍稍好些了：）</p>

]]></content>
  </entry>
  
</feed>

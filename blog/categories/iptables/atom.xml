<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: iptables | dawncold's tech blog]]></title>
  <link href="http://www.youth2009.org/blog/categories/iptables/atom.xml" rel="self"/>
  <link href="http://www.youth2009.org/"/>
  <updated>2012-12-17T20:54:54+08:00</updated>
  <id>http://www.youth2009.org/</id>
  <author>
    <name><![CDATA[dawncold]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[NAT实践]]></title>
    <link href="http://www.youth2009.org/blog/2012/10/09/nat-practical/"/>
    <updated>2012-10-09T14:09:00+08:00</updated>
    <id>http://www.youth2009.org/blog/2012/10/09/nat-practical</id>
    <content type="html"><![CDATA[<p>昨天用LXC建立了不少container，分别用来做webserver、databaseserver等等，让这些container运行着各自程序启动后如果有外部访问，就会通过iptables把请求发送到各自的地方，这里需要宿主机器做NAT。比如访问80端口，我会把请求转发到内部10.0.3.20这台container来处理，相应的response也会返回过去。这样就做到了服务隔离。</p>

<p><code>bash
sudo iptables -t nat -A PREROUTING -i eth1 -p tcp --dport 80 -j DNAT --to 10.0.3.20
sudo iptables -t nat -A POSTROUTING -o eth1 -s 10.0.3.20 -j SNAT --to 200.200.200.25
</code></p>

<p>这样就把进入的请求都发到了10.0.3.20这台container上去处理。</p>

<p><img src="http://pic.yupoo.com/dawncold0/CkkIbzDr/medish.jpg" alt="nat" /></p>

<p>只默认开了一个nginx，就这样的效果。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[保存iptables规则遇到的问题]]></title>
    <link href="http://www.youth2009.org/blog/2012/02/07/some-issue-when-saving-rules-in-iptables/"/>
    <updated>2012-02-07T18:03:00+08:00</updated>
    <id>http://www.youth2009.org/blog/2012/02/07/some-issue-when-saving-rules-in-iptables</id>
    <content type="html"><![CDATA[<pre><code>        &lt;p&gt;开了vps竟然没开vpn简直是罪过了，只是因为前段时间vps升级到了centos6，挺多东西支持不好，于是安装vpn也就失败了，现在已经没问题了，刚刚用iPad测试了vpn可用。&lt;/p&gt;
</code></pre>

<p>在保存iptables规则的时候遇到这样的问题：</p>


<br /><pre class="prettyprint linenums bush:bash" lang="bash">iptables: Saving firewall rules to /etc/sysconfig/iptables: /etc/init.d/iptables: line 268: restorecon: command not found</pre>


<br /><p>当然你可能会看到中文的提示（我的就是），意思是一样的。从<a href="http://www.live-in.org/archives/1112.html">这里</a>得到了解决方案：</p>


<p>安装一个包包：</p>


<br /><pre class="prettyprint linenums bush:bash" lang="bash">yum install policycoreutils</pre>


<br /><p>行了，剩下就没遇到问题了：）</p>


<p>稍稍广告一下吧：欢迎使用Yardvps的VPS哦，我就在使用，现在很稳定，现在有了中文界面，支持支付宝，挺好吧？可以点击<a href="http://www.yardvps.com/billing/aff.php?aff=399">这里</a>购买，这样我也许能得到一点推广费用：）</p>

]]></content>
  </entry>
  
</feed>

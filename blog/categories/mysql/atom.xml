<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: mysql | dawncold's tech blog]]></title>
  <link href="http://www.youth2009.org/blog/categories/mysql/atom.xml" rel="self"/>
  <link href="http://www.youth2009.org/"/>
  <updated>2013-01-01T08:36:58+08:00</updated>
  <id>http://www.youth2009.org/</id>
  <author>
    <name><![CDATA[dawncold]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[终于又回到了开发一线]]></title>
    <link href="http://www.youth2009.org/blog/2012/08/09/return-to-develop/"/>
    <updated>2012-08-09T10:45:00+08:00</updated>
    <id>http://www.youth2009.org/blog/2012/08/09/return-to-develop</id>
    <content type="html"><![CDATA[<pre><code>        &lt;p&gt;前两天把系统从Lion升级到了MountainLion，这一升级不要紧，很多开发环境都需要重装，比如Java又得重新下载，Python的类库又消失了，XCode过期了。。。&lt;/p&gt;
</code></pre>

<p>听说了一个好消息，从XCode4.4.1开始，以后的XCode都会采用增量更新，但这次除外，1.56Gb的XCode，在这种破网速中用了两天才搞定。</p>


<p>Python的一个类库MySQL-python需要gcc-4.2才能编译，于是还需要下载CommandLineTool，又是155Mb。。。（但装好XCode后可以从XCode.app中找到llvm-gcc-4.2，我是用这个编译的，也能用）。</p>


<p>还有几个小的python类库，装好后就能继续用了。这次系统升级后MySQL竟然没有问题，值得表扬一下！</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[mysql只允许127.0.0.1连接的解决方法]]></title>
    <link href="http://www.youth2009.org/blog/2012/06/05/solved-mysql-refuse-localhost-connection/"/>
    <updated>2012-06-05T10:30:00+08:00</updated>
    <id>http://www.youth2009.org/blog/2012/06/05/solved-mysql-refuse-localhost-connection</id>
    <content type="html"><![CDATA[<pre><code>        &lt;p&gt;我上次记录过一次这样的情况，突然间所有的php应用无法连接数据库了，但可惜我忘记是为何导致了这样的结果，总是有很多奇怪的地方在这个vps上发生，比如有次突然在某个app中出现了嵌入的广告，这个app可是我写的呀，怎么会有广告？！还有就是那次mysql突然无法连接了，最后用127.0.0.1代替了localhost。&lt;/p&gt;
</code></pre>

<p>昨晚国庆安装了织梦的后台，但提示无法使用数据库，由于昨天太晚了没有深入研究，早晨起来看了一下，有人说去查看data/common.inc.php文件中的信息，我去看了一下，突然想起来localhost不能用了，于是改为127.0.0.1就可以了，但这也只是缓兵之计，于是想办法解决！</p>


<p>解决方法也不尽相同，就是在php.ini中的三处添加“/tmp/mysql.sock”，那三处就是：mysql.default_socket、mysqli.default_socket、pdo_mysql.default_socket，看名字就是php连接mysql的三种方法的默认socket路径，原来我就修改了两处，漏掉了mysqli这种，结果现在不少程序都是用这种方式连接，比如phpmyadmin和织梦，所以呢，修改了这三处就ok了（当然你得确定你用socket这种方式连接）</p>


<p>至此我的phpmyadmin也可以用socket登录了，织梦也能访问数据库了，再也不用127.0.0.1啦~</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ldconfig: /usr/lib/libmysqlclient.so.16 is not a symbolic link的问题]]></title>
    <link href="http://www.youth2009.org/blog/2012/05/23/two-mysql-lib-issue-after-yum-update/"/>
    <updated>2012-05-23T19:50:00+08:00</updated>
    <id>http://www.youth2009.org/blog/2012/05/23/two-mysql-lib-issue-after-yum-update</id>
    <content type="html"><![CDATA[<pre><code>        &lt;p&gt;刚刚用yum升级了系统，发现日志中有很多这样的提示：&lt;/p&gt;
</code></pre>

<p><span style="color: #111111; font-family: 微软雅黑, Arial, Helvetica, sans-serif; font-size: 12px; line-height: 20px; text-align: left;">ldconfig: /usr/lib/libmysqlclient.so.16 is not a symbolic link</span></p>


<p><span style="color: #111111; font-family: 微软雅黑, Arial, Helvetica, sans-serif; font-size: 12px; line-height: 20px; text-align: left;">ldconfig: /usr/lib/libmysqlclient_r.so.16 is not a symbolic link</span></p>


<p>于是Google了一下，找到一个解决方法，在<a href="http://tiger.im/286.html" target="_blank">这里</a>.</p>


<p>就是重建了两条连接过去即可：</p>


<br /><pre class="prettyprint linenums bush:bash" lang="bash">ln -sf /usr/local/mysql/lib/mysql/libmysqlclient.so.16 /usr/lib/mysqlclient.so.16


<p>ln -sf /usr/local/mysql/lib/mysql/libmysqlclient_r.so.16 /usr/lib/libmysqlclient_r.so.16</pre></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[网站都挂掉了]]></title>
    <link href="http://www.youth2009.org/blog/2012/05/02/mysql-issue/"/>
    <updated>2012-05-02T18:17:00+08:00</updated>
    <id>http://www.youth2009.org/blog/2012/05/02/mysql-issue</id>
    <content type="html"><![CDATA[<pre><code>        &lt;p&gt;突然发现mysql无法用localhost连接进去，而用127.0.0.1可以。&lt;/p&gt;
</code></pre>

<p>linux下是这样的，如果用localhost连接是走的socket路线，用127.0.0.1走的是tcp路线。</p>


<p>修改了php.ini中的mysql.default_socket，值为mysql.sock的文件路径，重启php就好了，不过phpmyadmin的问题依然没有解决，我只是把连接主机换成了127.0.0.1暂时用着。</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[用python备份mysql]]></title>
    <link href="http://www.youth2009.org/blog/2012/04/27/backup-mysql-databases-using-python/"/>
    <updated>2012-04-27T20:44:00+08:00</updated>
    <id>http://www.youth2009.org/blog/2012/04/27/backup-mysql-databases-using-python</id>
    <content type="html"><![CDATA[<pre><code>        &lt;p&gt;备份数据库的重要性不想多说了。&lt;/p&gt;
</code></pre>

<br /><pre class="prettyprint linenums bush:python" lang="python">#! /usr/bin/env python


<h1>coding: utf-8</h1>

<p>import os
import sys
from datetime import *
import time</p>

<h1>mysql's path</h1>

<p>mysql_path = '/usr/local/mysql/bin/'</p>

<h1>edit this if your mysql username and password is not like this:</h1>

<p>mysql_username = 'root'
mysql_password = 'xxxxxx'</p>

<h1>backup path</h1>

<p>backup_path = 'mysqlbackup/'</p>

<p>def validate_backup_path():</p>

<pre><code>if os.path.exists(backup_path) == False:
    print "I create a directory here: %s " % backup_path
    os.mkdir(backup_path)
</code></pre>

<p>def backup_all_databases():</p>

<pre><code>filename = "all_%s.sql" % (datetime.utcfromtimestamp(time.time()))
os.system("%smysqldump -u%s -p%s --all-databases &amp;gt; '%s%s'" % (mysql_path, mysql_username, mysql_password, backup_path, filename))
</code></pre>

<p>if <strong>name</strong> == "<strong>main</strong>":</p>

<pre><code>validate_backup_path()
backup_all_databases()
print "finish!!!"&lt;/pre&gt;
</code></pre>

<br /><p>这个是修改了一次的备份脚本，本来是分数据库备份的，无奈制定了分数据库备份需要输入密码，这就不容易加入cron来自动完成了，不过听说在my.cnf中加入mysqldump的设置可以避免输入账号密码，这也算是一个办法吧，不过还是本着简化的思想，只导出所有数据库出来就好，配合着上一篇的dropbox自动备份，这样VPS的灾备就稍稍好些了：）</p>

]]></content>
  </entry>
  
</feed>

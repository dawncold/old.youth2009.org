<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Trade Off]]></title>
  <link href="http://www.youth2009.org/www/atom.xml" rel="self"/>
  <link href="http://www.youth2009.org/www/"/>
  <updated>2014-01-06T22:16:41+08:00</updated>
  <id>http://www.youth2009.org/www/</id>
  <author>
    <name><![CDATA[dawncold]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[daemon-in-nginx]]></title>
    <link href="http://www.youth2009.org/www/blog/2014/01/06/daemon-in-nginx/"/>
    <updated>2014-01-06T21:57:39+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2014/01/06/daemon-in-nginx</id>
    <content type="html"><![CDATA[<p>最近要把bnly重新运行起来，前两天整理了cli版本的程序，放到<a href="GitHub">https://github.com/dawncold/bnly-cli</a>，另一个web版的放到了bitbucket上的私有仓库，准备做部署的时候用，没想到bitbucket最近没有被kill，难道放开了？</p>

<p>用supervisor做进程管理的时候被nginx坑了，由于nginx的配置很强大，现在还处在搭建环境的初期，很多配置写不完整，导致了nginx总是在频繁启动，log中看到的是80端口已经被占用。。。找了半天只有nginx占着80，而且又不会开多个nginx（supervisor的配置中没有明确说开多个程序，默认一个），搜了挺长时间都没有结果。</p>

<p>突然想到了daemon。</p>

<p>nginx的文档建议生产环境应该off，但这个和我遇到的问题无关。默认daemon开了，supervisor运行后会认为nginx退出了，再启动一个，其实上一个已经启动成功，所以就总看到80端口被占用，于是在nginx的配置上加<code>deamon off</code>即可。</p>

<p>是不是很坑？</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Object.keys-and-JSON-in-IE6]]></title>
    <link href="http://www.youth2009.org/www/blog/2013/12/08/object-dot-keys-and-json-in-ie6/"/>
    <updated>2013-12-08T14:52:12+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2013/12/08/object-dot-keys-and-json-in-ie6</id>
    <content type="html"><![CDATA[<p>下单页面用到了js中的JSON和Object.keys，都是坑。</p>

<p>JSON虽然是build-in的JSON parser和stringify方法，但IE6，7，8(Q)都是无法使用的，如果用jQuery的话，可以用jQuery的parseJSON来解析，但stringify的话需要依赖第三方库或者自己实现，我用了JSON3.js这个库。首选build-in的parse和stringify方法，如果没有就实现。github地址：<a href="https://github.com/bestiejs/json3">https://github.com/bestiejs/json3</a></p>

<p>同样的Object.keys()因为不能在IE9下使用，因为要取一个Object的keys数量，有的时候是用Object的keys列表，所以以后为了兼容，就只能：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">p</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">p</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">count</span><span class="o">++</span><span class="p">;</span>
</span><span class='line'>      <span class="nx">keys</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">p</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[useful-shell-command]]></title>
    <link href="http://www.youth2009.org/www/blog/2013/12/07/useful-shell-command/"/>
    <updated>2013-12-07T22:28:53+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2013/12/07/useful-shell-command</id>
    <content type="html"><![CDATA[<p>找到size为0的文件，并删除：<code>find -type f -size 0 | xargs rm</code></p>

<p>替换Linux的换行成windows的：<code>ls | xargs perl -i -pe 's/\n/\r\n/g'</code></p>

<p>批量改名哦（把<em>.md改为</em>.markdown）：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="k">for </span>i in <span class="sb">`</span>ls *.md<span class="sb">`</span>;<span class="k">do </span>mv <span class="nv">$i</span> <span class="sb">`</span><span class="nb">echo</span> <span class="nv">$i</span> | sed <span class="s1">&#39;s/.md/.markdown/&#39;</span><span class="sb">`</span>;<span class="k">done</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[upgrade-to-linode-for-not-waiting]]></title>
    <link href="http://www.youth2009.org/www/blog/2013/12/03/upgrade-to-linode-for-not-waiting/"/>
    <updated>2013-12-03T22:32:58+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2013/12/03/upgrade-to-linode-for-not-waiting</id>
    <content type="html"><![CDATA[<p>上个月买了linode的vps，不知道干什么用，光翻墙了，月底干脆就关了，觉得这样翻墙的成本太高了，完全可以租个便宜的vps来用，后来觉得还是linode好。</p>

<p>在用linode之前用过digitalocean，那时候DO刚刚起步，速度不错，主要是华人不多，而且价格一如既往的便宜，公司决定买这个翻墙用，但后来速度一天天慢下来了，看到最近DO的推广力度增大，可能这就是为啥速度不理想的原因。</p>

<p>prgmr.com是个不错的vps，技术感超强，但很可惜在公司速度很好，160ms的ping延迟，不过回到家发现延迟到了400+，真不明白网络就能差这么多。好处是能不交费先用一段时间体验，support很好。</p>

<p>ramhost.us据说也不错，不会超售，在家wget一个文件速度上了400+，可惜就那么一次，也不知道是不是那一次把所有RP全用光了，后来怎么都是个位数的速度。同样技术感很强，缺点就是support靠人，站长貌似也不总是盯着这个，没拿到trial来试试。</p>

<p>其实vpsee这个也能考虑试试，linuxtoy.org放在上面，感觉访问速度挺好，价格10刀，不算是便宜，但和linode比便宜一半了。以前用过几个月的vps，很稳定，被GFW过IP，站长免费给换，总之一切都好。</p>

<p>最后是linode，又回来了，很早很早的时候，大约是初中那会，对建站很感兴趣，那时候还没有流行vps，都是shared hosting，当时买过hostmonster的一年服务，没做啥东西，算是浪费了吧。后来过了挺长时间逐渐接触到vps，用过yardvps，amazon的也试过，那时候没法买linode，因为信用卡，就想着哪天能有信用卡了就可以自由买这个了，现在确实能买了，也不知道买了干嘛了，以为能做个app，但终究没想出来做什么。好在能解决访问Google等网站时候的延迟，有时候大脑在想一件事，google一下结果，此时慢了，可能又跳跃到别的事情上了。或许人和人不太一样。</p>

<p>Linode Referral URL：<a href="https://www.linode.com/?r=84379f19216416e48085518afcde3beb02aee9c8">https://www.linode.com/?r=84379f19216416e48085518afcde3beb02aee9c8</a></p>

<p>Linode Referral Code：84379f19216416e48085518afcde3beb02aee9c8</p>

<p>如果用这个code注册linode，在你用满3个月的时候我们彼此能够得到20刀的奖励：）</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[rarp]]></title>
    <link href="http://www.youth2009.org/www/blog/2013/08/25/rarp/"/>
    <updated>2013-08-25T12:01:00+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2013/08/25/rarp</id>
    <content type="html"><![CDATA[<h2>Packet Format</h2>

<p>RARP packet is identical to ARP packet, differences: RARP &lsquo;type&rsquo; field is 0x8035 for request and reply and &lsquo;op&rsquo; field is 3 for RARP request and 4 for RARP reply.</p>

<p>RARP&rsquo;s reply is unicast.</p>

<p>The implementation of RARP server is complex&hellip;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[timestamp]]></title>
    <link href="http://www.youth2009.org/www/blog/2013/08/20/timestamp/"/>
    <updated>2013-08-20T21:56:00+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2013/08/20/timestamp</id>
    <content type="html"><![CDATA[<p>今天在做批量导入图片功能的时候，发现一个问题，原先save image过程用timestamp当文件名，这样在一般使用的时候倒是没什么问题了，但让程序去做的时候，timestamp就显得不好用了，程序跑的很快，可能三四张图都在1s内处理完上传，这样就很难保证文件名不重复。</p>

<p>传一张停1秒呢？问题不大，但看着还是不保险，而且变慢了，因为要等。。。</p>

<p>纯粹uuid倒是问题不大，但日后管理起来确实就不爽了——看uuid根本不知道谁先谁后，所以就把tiemstamp和uuid4连起来当新文件名，这样程序批量传也不会有问题（其实概率已经低到这个时代可接受的程度吧），又在trade off了。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[conceptual-models]]></title>
    <link href="http://www.youth2009.org/www/blog/2013/08/19/conceptual-models/"/>
    <updated>2013-08-19T22:12:00+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2013/08/19/conceptual-models</id>
    <content type="html"><![CDATA[<h2>Conceptual Models</h2>

<p>Designing software so that its structure reflects that of the problem.</p>

<p>Analysis is not only listing requirments, but also looking behind the surface requirments to come up with a mental model of what is going in the problem.</p>

<p>Conceptual model is a human artifact.</p>

<p>Developers use conceptual models to represent a model of the real world in order to understanding the read part of problems easily.</p>

<p>There is no right or wrong model, merely one that is more useful for the job at hand.</p>

<p>The example, snooker simulation, if your choose a Einsteinian model would be flexible enought to low speed or high speed situation, but the complexity is totally different you know, so the flexibility and many others aspects need a trade-off.</p>

<p>When building a model in a programming language, maybe Python, you may get lost in this language or building this model using some features belong to Python, so this model is a Python-model, and it is hard to be implemented in other languages such as Java, PHP, etc. To avoid these problems, you need a third-party analysis techniques.</p>

<p>Only domain experts could build right model, because of their domain knowledge.</p>

<p>Conceptual model is closely to software interfaces rather than software implementations. One of the important things about OO is that it separates interface from implementation.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[arp]]></title>
    <link href="http://www.youth2009.org/www/blog/2013/08/18/arp/"/>
    <updated>2013-08-18T20:38:00+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2013/08/18/arp</id>
    <content type="html"><![CDATA[<pre><code>32 bits Internet address
|                   /|
|ARP                 |RARP
|/                   |
48 bits Ethernet address
</code></pre>

<h1>Gratuitous ARP</h1>

<ol>
<li>send its own IP to verify whether someone has used this.</li>
<li>update old MAC address in ARP cache</li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[manage-rasp-pi-in-internal-network]]></title>
    <link href="http://www.youth2009.org/www/blog/2013/08/08/manage-rasp-pi-in-internal-network/"/>
    <updated>2013-08-08T22:16:00+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2013/08/08/manage-rasp-pi-in-internal-network</id>
    <content type="html"><![CDATA[<p>今天早晨去公司后一开邮箱发现好多树莓派发来的警告信，如果是一封信可能是误报，但这么多，难道是真的有人闯入？不过看了大部分的图片都是空空的房间，但仍然有新的邮件过来，看来是红外探测器出问题了。</p>

<p>想了半天以为是昨天加的DHT11在读取数据的时候是不是改变了GPIO的布局，导致探测器的数据口得到数据，激活了它？后来证明不是。猜测啊：探测器放到了无线网卡下方，无线网卡有个工作指示灯一直闪烁，会不会触发了探测器，因为我换了个地方后探测器就正常工作了。</p>

<p>在没有远程管理的前提下，解决的方法是去七牛把bucket先删掉，这样就不能再上传图片了，然后去sendgrid修改密码，这样就不能发送邮件了。其实我期待能引发一个异常，这样程序就退出了，但很可惜，七牛的lib似乎做了些处理，删掉bucket或者修改API KEY这样的方法也就是给个提示出来，他们处理了异常，不过好在sendgrid的lib没有处理异常，密码错误后引发的异常终止了程序！GREAT！我还担心了一天摄像头不断拍照会不会坏掉。</p>

<p>上面都是背景吧，主题是一个远程管理的重要性，特别是出现这种突发情况而你又不在边上。</p>

<p>受限于当地的网络环境，树莓派在一个很深的网络中——有家庭的路由器，再往上是小区的路由器，也许再往上就是公网IP了，和在原来的家不同，直接能拿到公网IP，这样基本可以让树莓派暴露在公网上，管理起来当然方便了。穿透这么多层网络，感觉好麻烦，虽然毕业论文是NAT穿透的应用。。。</p>

<p>简单的做法就是利用第三方，我有一个VPS，当然在海外，除了速度上不如国内快之外，别的没啥了。</p>

<p>于是在树莓派上建立一个反向SSH：<code>ssh -p VPS_PORT -fNR 2222:127.0.0.1:22 USER@VPS_HOST</code>，其中VPS_PORT如果你没修改默认的22的话，可以不写<code>-p VPS_PORT</code>，其他的，比如<code>fN</code>，你可以先不写，测试成功后再写上，只做端口转发而不执行命令。后面的R表示反向连接：就是127.0.0.1的22端口在后面远程主机中映射到2222端口。这样，登陆了远程主机的人，访问2222端口就可以访问到树莓派的22端口了。</p>

<p>再临时生成几个rsa key加到authorized_keys中就可以不输密码登陆了，虽然速度稍慢一点，但至少是可用的！</p>

<p>测试通过后使用autossh建立连接，这样即便是中断也会重连上：）</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[basestring-and-str-in-python2x]]></title>
    <link href="http://www.youth2009.org/www/blog/2013/08/08/basestring-and-str-in-python2x/"/>
    <updated>2013-08-08T21:39:00+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2013/08/08/basestring-and-str-in-python2x</id>
    <content type="html"><![CDATA[<p>今天在代码中发现原本过滤str的一个func被写成了过滤basestring，于是查了下basestring和str的区别：(在3.0之前)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>    object
</span><span class='line'>         |
</span><span class='line'>         |
</span><span class='line'>     basestring
</span><span class='line'>        / \
</span><span class='line'>       /   \
</span><span class='line'>     str  unicode</span></code></pre></td></tr></table></div></figure>


<p>3.0之前python中有plain string和unicode string，前者是ascii中的那些字符，后者就是所有字符了，因为historical legacy。。。python出现的时候还木有unicode，所以很多python的lib是需要慢慢转换的，当然到了3.0就会不复存在了，全是unicode。</p>

<p>这样的话就清楚了，str代表了那些ascii字符，unicode就是全部的字符，他们都继承自basestring。basestring是从python2.3开始引入的。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[opencv-with-pi]]></title>
    <link href="http://www.youth2009.org/www/blog/2013/08/03/opencv-with-pi/"/>
    <updated>2013-08-03T17:44:00+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2013/08/03/opencv-with-pi</id>
    <content type="html"><![CDATA[<p>想了好久都觉得连续拍照片做监控实在是没什么效率，默认情况应该是什么都不做，如果发现有人来了才拍下来或者录下来，但用标配的摄像头录像实在是会录出非常大的文件，保存文件又是问题。在<a href="http://www.raspberrypi.org/archives/4207">官网的博客</a>中看到了一个用opencv做的人脸识别，可以这样干嘛。于是紧随那片文章开始干。</p>

<p>由于标配摄像头模块不是usb设备，所以需要重新编译使用的几个程序，比如raspistill和raspivid等等。</p>

<p>另外，如果直接在raspberrypi上编译，需要安装一些软件：<a href="http://thinkrpi.wordpress.com/2013/04/05/step-3-install-softwares-for-webcam-and-computer-vision/">http://thinkrpi.wordpress.com/2013/04/05/step-3-install-softwares-for-webcam-and-computer-vision/</a></p>

<p>具体的操作请参照：<a href="http://thinkrpi.wordpress.com/2013/05/22/opencv-and-camera-board-csi/">http://thinkrpi.wordpress.com/2013/05/22/opencv-and-camera-board-csi/</a></p>

<p>替换arm-linux.cmake的命令:<code>sed -i 's/if (DEFINED CMAKE_TOOLCHAIN_FILE)/if (NOT DEFINED CMAKE_TOOLCHAIN_FILE)/g' arm-linux.cmake</code>，看准了arm-linux.cmake的路径，我运行命令的时候已经到了和arm-linux.cmake一个目录下了。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[got-raspberry]]></title>
    <link href="http://www.youth2009.org/www/blog/2013/08/02/got-raspberry/"/>
    <updated>2013-08-02T21:40:00+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2013/08/02/got-raspberry</id>
    <content type="html"><![CDATA[<p>工资一发就买了块表。。。并且还狠心买了这个玩具——raspberry。</p>

<p>默认用了新手的那个镜像，叫NOOBS，就是里面装好了不少东西，系统也有好几个，默认用了推荐的Raspbian，是Debian的一个变种啦，开发用的Ubuntu都是一个家族的。</p>

<p>配置的话，没啥可说的，就是把显卡占用的内存改成了16Mb，默认似乎分配了128M过去，对于我这种总看命令行的人足够了。如果你和我一样买了官方的摄像头模块，那就可以把camera给enable了。再就是在adcanced options中把SSH打开，否则你还得连上键盘鼠标去操作。。。</p>

<p>不喜欢插网线，但很可惜办公室的Cisco双频无线网卡AE2500装不上，貌似是驱动问题，不想折腾，还好买了个免驱的小网卡叫EOUP。我的无线路由是hidden SSID了，所以在连接的时候还有点问题。在配置文件<code>/etc/wpa_supp/wpa_supp.conf</code>中多加了一行：
<code>scan_ssid=1</code></p>

<p>apt的source也改到了ustc.edu.cn的：<code>http://mirrors.ustc.edu.cn/raspbian/raspbian/</code>，具体就是把<code>/etc/apt/source.list</code>中第一行的URL改成上面那个即可。</p>

<p>camera的官方使用教程：<a href="http://www.raspberrypi.org/archives/3890">http://www.raspberrypi.org/archives/3890</a></p>

<p>如果想用camera捕捉视频，然后传到你这里看的话，需要在raspberry上先装netcat，我是用的Mac系统，系统本身有nc了，再用brew多装一个mplayer。</p>

<p>raspberrrypi上捕捉视频用：<code>raspivid -t 1000000 -vs -w 800 -h 600 -o -| nc 172.19.1.124 5001</code>，其中t参数指定了捕捉多少毫秒的视频，后面的vs是防抖，w和h控制宽高，这样就得到一个800x600的画面。</p>

<p>Mac上用nc把发来的stream转到mplayer上：<code>nc -lp 5001 | mplayer -fps 31 -cache 512 -</code>，很无语的是<code>man nc</code>得到一句解释，l和p参数在一起用是个错误，但不加p就绝对在我这里不work！</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[internet protocol]]></title>
    <link href="http://www.youth2009.org/www/blog/2013/07/27/internet-protocol/"/>
    <updated>2013-07-27T23:02:00+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2013/07/27/internet-protocol</id>
    <content type="html"><![CDATA[<p>TCP, UDP, ICMP, IGMP need IP datagrams as data transmitting method.</p>

<p>IP is a unrealiable and connectionless delivery service.</p>

<ul>
<li>unrealiable: no guarantee that an IP datagram successfully get to its destination.</li>
<li>connectionless: IP doesn&rsquo;t maintain any state of successive datagrams, it means there is no order in IP datagrams, latter sent IP datagram may arrived before former sent.</li>
</ul>


<h2>Header</h2>

<p>TOS: 3 bits precedence field(ignored today), 4 bits TOS(mini delay, max throughput, max relability, mini monetary cost), 1 bit always 0. TOS maynot supported by most TCP/IP implementations today, but some routing protocol such as OSPF and IS-IS are capable of making routing decisions based on this field.</p>

<p>Furthermore, a host isn&rsquo;t required to receive a datagram larger than 576 bytes. TCP and UDP will divide user data into small pieces, so one IP datagram will below that limit.</p>

<p>Some small IP datagram will be padded up to the mini length of frame, which maybe 46 or 38 bytes, so total length field is required when you want to know how long the IP datagram&rsquo;s length on earth.</p>

<p>TTL: set by sender, if this datagram pass a router, it will decrease 1, when it reaches 0, this datagram will thrown away, and sender will received an ICMP message. prevent routing loop.</p>

<p>Checksum: TCP, UDP, ICMP, IGMP use same algorithm to computing checksum. Since a router often cheages only TTL value, a router can incrementally update the checksum when it forwards a datagram, instead of calculating the checksum over the entire IP header again.</p>

<h2>IP routing</h2>

<p>The fundamental difference is that a host never forward a datagram from one of its interface to another, while a router forwards datagram.</p>

<p>Router may reach a local optimum result, because every search route table, the router will get a closer next-hop router address, but it may not global optimum.</p>

<p>Frame&rsquo;s destination address(MAC address) may not the really destination address, it may the next-hop router&rsquo;s MAC address, because when it is routing, it can&rsquo;t be found in the current network, it must be routed to a next-hop router, so the destination address is the next-hop router&rsquo;s.</p>

<h2>Subnet addressing</h2>

<p>Don&rsquo;t forget subtract 2, because all 0 bits and all 1 bits address for host address is invalid.</p>

<p>The advantage to using s single class B address with 30 subnets, compared to 30 class C addresses, is that subnetting reduces the size of the Internet&rsquo;s routing tables entry.</p>

<p>A special address: 127.x.x.x means loopback address, not only 127.0.0.1 can be loopback address!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[link-layer]]></title>
    <link href="http://www.youth2009.org/www/blog/2013/07/27/link-layer/"/>
    <updated>2013-07-27T00:03:00+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2013/07/27/link-layer</id>
    <content type="html"><![CDATA[<h2>link layer</h2>

<h3>link layer&rsquo;s usage</h3>

<ol>
<li>send and receive IP datagram</li>
<li>ARP request and reply</li>
<li>RARP request and reply</li>
</ol>


<p>many different link layers, depending on the type of networking: ethernet, token ring, FDDI, RS232 serial lines, etc.</p>

<p>IEEE 802.2/3 format and Ethernet format</p>

<p>in 802 format, after 2 bytes length field, there are 3 bytes LLC and 5 bytes SNAP and data field(38~1492) but in Ethernet format, there will be data field(46~1500), the end field is 4 bytes CRC.</p>

<p>frame formats use 48-bits destination and source address</p>

<h2>SLIP: Serial Line IP</h2>

<p>END &mdash; 0xc0</p>

<p>SLIP ESC &mdash; 0xdb</p>

<p>IP datagram will be terminated by a special character called END(0xc0), most implementations transmit an END at the beginning of the datagram.</p>

<p>if a byte of IP datagram equals:</p>

<p>0xc0 &mdash;> 0xdb, 0xdc</p>

<p>0xdb&mdash;>0xdb, 0xdd</p>

<h2>PPP</h2>

<ol>
<li>async link with 8bits of data and no parity(no checksum)</li>
<li>bit-oriented sync links</li>
</ol>


<p>start and end with a flag byte whose value is 0x7e, and if a byte value appears in information field, it should be escaped.</p>

<p>batter than SLIP:(pay for 3 bytes addition)</p>

<ol>
<li>multiple protocols on a serial line</li>
<li>CRC</li>
<li>IP network control protocol negotiate IP address for each end</li>
<li>header compress like CSLIP</li>
<li>link control protocol negotiate many data-link options</li>
</ol>


<h2>Loopback</h2>

<p>127.0.0.1 or localhost is the loopback interface, an IP datagram sent to this must not appear on any network.</p>

<p>datagrams sent to broadcast and multicast addtess are copied to the loopback interface and sent out on the Ethernet.</p>

<p>anything sent to one of the host&rsquo;s own IP addresses is ent to the loopback interface!</p>

<h2>MTU</h2>

<p>if the length of data field in IP datagram is larger than MTU(1500 or 1492 in Ethernet and 802 format), it will be fragmented.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[OCP-talks]]></title>
    <link href="http://www.youth2009.org/www/blog/2013/07/26/ocp-talks/"/>
    <updated>2013-07-26T22:27:00+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2013/07/26/ocp-talks</id>
    <content type="html"><![CDATA[<p>Good design should be open for extension and closed for modification. You can extend the module instead of modifying some working code.</p>

<p>Abstraction is the Key: for example, a Client should use an Server object that implemented some interfaces instead of a concrete Server object.</p>

<p>Interface&rsquo;s name should be named more closely associated to the dependent side instead of the implement side.</p>

<p>A function that is closed for modification: if we add some changes for this function, it must be modified for working right, it may unconform OCP. For example, a function that draw all shapes in a shape list, it should be draw shapes one by one, and don&rsquo;t care this shape should draw in this way, another shape should draw in that way, etc.</p>

<p>No matter how &ldquo;closed&rdquo; a module is, there will always be some kind of change against which it is not closed.</p>

<p>Abstraction may gain &ldquo;closed&rdquo; software entity(func, module, class, etc), but it also need trade off.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[use-change-event-on-checkbox]]></title>
    <link href="http://www.youth2009.org/www/blog/2013/07/26/use-change-event-on-checkbox/"/>
    <updated>2013-07-26T09:07:00+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2013/07/26/use-change-event-on-checkbox</id>
    <content type="html"><![CDATA[<p>昨天在一个table的第一行放了一个checkbox, 想做一个效果：一开始这个table的每一行都是冻结状态，点击这一行就激活了，顺便会把checkbox选中，当然直接点checkbox也会激活这一行。可惜在bind event的时候，分别给tr和checkbox加了click事件，tr的click会trigger到checkbox上，这样导致的结果就是点tr会触发checkbox的click handler，但同时又触发了tr的click handler，循环导致最后js崩溃。</p>

<p>后来发现在tr的click handler中检查event.target可以不触发这种死循环，但在checkbox click handler中使用prop判断checked状态不准，在stackoverflow中找到解答：jquery1.8中的 click()和真实的click是不一样的，应该在checkbox上用change event，然后一切ok。</p>

<p>解答：<a href="http://stackoverflow.com/questions/7668826/jquery-triggerclick-not-firing-click-event-on-checkbox">http://stackoverflow.com/questions/7668826/jquery-triggerclick-not-firing-click-event-on-checkbox</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[crontab a python script]]></title>
    <link href="http://www.youth2009.org/www/blog/2013/07/21/crontab-a-python-script/"/>
    <updated>2013-07-21T22:28:00+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2013/07/21/crontab-a-python-script</id>
    <content type="html"><![CDATA[<p>今天用python写了个<a href="https://github.com/dawncold/stuff/blob/master/ping_test.py">小程序</a>检测网络是否通断，如果断了就弹出一个Notification，当然是Mac上的，并且弹出一个terminal，带着执行ping www.baidu.com。</p>

<p>一开始用Lingon加入到启动项中并且打算2分钟执行一次，几经折腾终于失败，弃之。打算用crontab弄。</p>

<p>好歹算是可用了吧，注意的是：script的开头写/usr/bin/python，crontab中写PATH没用，得写PYTHONPATH才管用，而且我还写了MAILTO（现在不知道管什么用）。由于在script中用了popen，可能这个需要依赖一些环境或者是tty（这是从stackoverflow上看来的，具体可以搜popen crontab），现在想来launchd是不是也因为如此没能成功启动呢？（总提示255退出代码）</p>

<p>crontab:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">MAILTO</span><span class="o">=</span><span class="s2">&quot;dawncold@me.com&quot;</span>
</span><span class='line'><span class="nv">PATH</span><span class="o">=</span>/Users/dawncold/.rvm/gems/ruby-1.9.3-p286/bin:/Users/dawncold/.rvm/gems/ruby-1.9.3-p286@global/bin:/Users/dawncold/.rvm/rubies/ruby-1.9.3-p286/bin:/Users/dawncold/.rvm/bin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/local/sbin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/MacGPG2/bin
</span><span class='line'><span class="nv">PYTHONPATH</span><span class="o">=</span>/usr/bin
</span><span class='line'>* * * * * /Users/dawncold/ping_test.py &gt; /Users/dawncold/pt
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[suds-literal-soap]]></title>
    <link href="http://www.youth2009.org/www/blog/2013/07/08/suds-literal-soap/"/>
    <updated>2013-07-08T22:16:00+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2013/07/08/suds-literal-soap</id>
    <content type="html"><![CDATA[<p>SAP的接口就是和别人给的不一样，style为literal，最明显的地方就是operation中的参数是literal，原先的参数是一个object，按照原先的方法调用时发现传递过去的值都被放在了第一个参数中，很是不解。后来才知道这样的operation需要用keywords的那种传值方法——<code>**suds_client.dict(object)</code>，用suds的client的dict方法把构造的对象变成dict，再用<code>**</code>。</p>

<p>又被坑了一下。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[搭建4pm.la的数据库服务器]]></title>
    <link href="http://www.youth2009.org/www/blog/2013/07/04/build-4pm-env/"/>
    <updated>2013-07-04T21:54:00+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2013/07/04/build-4pm-env</id>
    <content type="html"><![CDATA[<p>原来用MySQL比较多，现在工作上主要用PostgreSQL，对于低级的应用来说，选什么数据库都差不多，但也要为以后发展做准备，不过我暂时看不到那么远，PG作为一个开源的数据库来说，还算是比MySQL有优势一点，所以就用这个了。</p>

<p>在Mac上安装的时候有个locale的选择，我选了这个：</p>

<p><img src="http://pic.yupoo.com/dawncold0/CZ9bpp9U/medish.jpg" alt="locale select" /></p>

<p>然后下载了pgAdmin作为GUI工具，结合PG的CLI一起使用比较好。使用psql登陆数据库可以用：<code>psql -h localhost -U postgres -W</code></p>

<pre><code>其中
-h db host
-U db user
-W use password
</code></pre>

<p>pgAdmin用起来感觉超差，目测是java写的，有点小卡，远不如在Ubuntu上的体验。</p>

<p>创建一个网站用的用户，可以用createuser这条命令，或者连上PG后写CREATE USER这种SQL，官方文档介绍两者没什么差别。createuser只是包装了一下SQL而已。（<a href="http://www.postgresql.org/docs/current/static/app-createuser.html">官方文档</a>）</p>

<p><code>createuser -dEeP -h localhost -U postgres -W xxx</code></p>

<pre><code>其中
-d can create db
-E encrypted user's password
-e echo SQL command
-P can not create role
</code></pre>

<p>创建一个数据库，同样可以用包装了CREATE DATABASE的createdb。(<a href="http://www.postgresql.org/docs/9.2/static/app-createdb.html">官方文档</a>）</p>

<p><code>createdb -e -E UTF8 -l zh_CN.UTF-8 -O OWNER -h localhost -U postgres -W DBNAME</code></p>

<pre><code>其中
-e echo SQL command
-E use encoding
-l set locale, included LC_COLLATE and LC_CTYPE
-O db's owner
</code></pre>

<p>看到篇不错的文章，介绍PG的ROLE、USER、SCHEMA、TABLESPACE、DATABASE等概念的关系：<a href="http://blog.csdn.net/kanon_lgt/article/details/5931522">这里</a></p>

<p>生产环境用的Ubuntu12.04.2，在创建数据库的时候制定locale，但没有zh_CN这个locale，于是需要安装：<code>/usr/shard/locales/install-language-pack zh_CN</code>，安装完了最好能重启机器，不然的话好像createdb一直会报错说zh_CN.UTF-8这个locale不正确。重启了之后再创建db就ok了，但告诉你说collection你选了zh_CN的，和默认模板template1的en_US冲突，提示是换成template0模板，于是加了参数<code>-T</code>:<code>createdb -e -E UTF8 -l "zh_CN.UTF-8" -O :OWNER -T template0 -h localhost -U postgres -W :DBNAME</code></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[without-nginx-upload-module]]></title>
    <link href="http://www.youth2009.org/www/blog/2013/07/01/without-nginx-upload-module/"/>
    <updated>2013-07-01T23:28:00+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2013/07/01/without-nginx-upload-module</id>
    <content type="html"><![CDATA[<p>前些天把nginx-upload-module这个依赖去掉了，用了nginx builtin的方法，感觉更好了，其实深层原因是这个module的作者不玩了。。。只有感受到了这种切肤之痛才有变革的动力！！！</p>

<p>主要内容记录在了这里：<a href="http://www.youth2009.org/blog/2013/06/25/nginx-upload-file-without-backend/">http://www.youth2009.org/blog/2013/06/25/nginx-upload-file-without-backend/</a></p>
]]></content>
  </entry>
  
</feed>

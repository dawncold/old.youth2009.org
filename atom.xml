<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Trade Off]]></title>
  <link href="http://www.youth2009.org/www/atom.xml" rel="self"/>
  <link href="http://www.youth2009.org/www/"/>
  <updated>2014-11-22T14:24:29+08:00</updated>
  <id>http://www.youth2009.org/www/</id>
  <author>
    <name><![CDATA[dawncold]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[linux-study]]></title>
    <link href="http://www.youth2009.org/www/blog/2014/11/22/linux-study/"/>
    <updated>2014-11-22T14:14:25+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2014/11/22/linux-study</id>
    <content type="html"><![CDATA[<p>directory permission x means this directory can be work directory, if you want to write or read a file behind this directory, you must have permission x of this directory.</p>

<p>directory permission w means you can delete or create files or directories behind this</p>

<p>usr = unix software resource</p>

<p>&ldquo;&ndash;&rdquo; means last work directory(cd /mnt;cd;cd &ndash;)</p>

<p>umask means default permission minus this mask, e.g default new directory 777, if mask is 022, then you will get 777-022——>755 directory; default new file 666, is mask is 002, then you will get 666 &ndash; 002——>664 file. mask only can be set in (1, 2, 4) every bit, one bit means the sum of one permission group(current/group/others). umask is based on user, default root has a 0022 mask, normal user has a 0002 mask.</p>

<p>lsattr/chattr is available on ext2/ext3 filesystem, add ‘+i’ attribute can lock one file, no edit or delete, even you are root, ‘+a’ attribute can let a file only accept append content, etc.</p>

<p>SUID, SGID, SBIT special permission:
there is a ’s’ on x position of user part, like ‘rws- &ndash; &ndash; &ndash; &ndash; -‘. SUID can only set to binary program, if user has x permission of this binary, it can temporarily get the owner permission of this binary, e.g binary ‘passwd’ and /etc/shadow file, shadow only can be updated by root, but every user can change their password via ‘passwd’, it means the user temporarily get owner(root) permission by SUID special permission.
SGID similar as SUID, there will be a ’s’ on x position of group part like ‘rwx- &ndash; s &ndash; &ndash; x’. if a user can execute binary, he will temporarily get owner permission, e.g binary ‘locate’ and file ‘mlocate.db’. SGID can be set on a directory, it means if a user have r and x permission of one directory, and ’s’ set on this directory, this user can create a file which owner group is this directory’s.
SBIT(Sticky BIT) only set to directory, if a directory has this permission, a user who can create file or directory on this directory, the new file or new directory can only delete by root or himself, e.g /tmp directory, root can delete your new file, and you can also delete it, but others can not.
SUID = 4, SGID = 2, SBIT = 1, chmod x755 xxx_file, x means sum of SUID, SGID, SBIT, if omit, this bit is zero, if you set a invalid SUID/SGID/SBIT, there will be upper case S/T, lower case is valid.</p>

<p>find / -size 1M -exec ls -l {} \;     {} means the args from find, “\;” means the end of “exec”, commands in exec can not use alias.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[aix-security]]></title>
    <link href="http://www.youth2009.org/www/blog/2014/11/22/aix-security/"/>
    <updated>2014-11-22T14:04:41+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2014/11/22/aix-security</id>
    <content type="html"><![CDATA[<p>some security configuration for AIX ssh and system services</p>

<p>create a user group named rmt_acc, only allow this group user access ssh, don&rsquo;t allow root login and use public key authentication.</p>

<h1>sshd_config content</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># $OpenBSD: sshd_config,v 1.77 2008/02/08 23:24:07 djm Exp $
</span><span class='line'>
</span><span class='line'>
</span><span class='line'># This is the sshd server system-wide configuration file. See
</span><span class='line'># sshd_config(5) for more information.
</span><span class='line'>
</span><span class='line'>
</span><span class='line'># This sshd was compiled with PATH=/usr/bin:/bin:/usr/sbin:/sbin
</span><span class='line'>
</span><span class='line'>
</span><span class='line'># The strategy used for options in the default sshd_config shipped with
</span><span class='line'># OpenSSH is to specify options with their default value where
</span><span class='line'># possible, but leave them commented. Uncommented options change a
</span><span class='line'># default value.
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>#Port 22
</span><span class='line'>#AddressFamily any
</span><span class='line'>#ListenAddress 0.0.0.0
</span><span class='line'>#ListenAddress ::
</span><span class='line'>
</span><span class='line'>
</span><span class='line'># Disable legacy (protocol version 1) support in the server for new
</span><span class='line'># installations. In future the default will change to require explicit
</span><span class='line'># activation of protocol 1
</span><span class='line'>Protocol 2
</span><span class='line'>
</span><span class='line'>
</span><span class='line'># HostKey for protocol version 1
</span><span class='line'>#HostKey /etc/ssh/ssh_host_key
</span><span class='line'># HostKeys for protocol version 2
</span><span class='line'>#HostKey /etc/ssh/ssh_host_rsa_key
</span><span class='line'>#HostKey /etc/ssh/ssh_host_dsa_key
</span><span class='line'>
</span><span class='line'>
</span><span class='line'># Lifetime and size of ephemeral version 1 server key
</span><span class='line'>#KeyRegenerationInterval 1h
</span><span class='line'>#ServerKeyBits 768
</span><span class='line'>
</span><span class='line'>
</span><span class='line'># Logging
</span><span class='line'># obsoletes QuietMode and FascistLogging
</span><span class='line'>#SyslogFacility AUTH
</span><span class='line'>#LogLevel INFO
</span><span class='line'>
</span><span class='line'>
</span><span class='line'># Authentication:
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>#LoginGraceTime 2m
</span><span class='line'>PermitRootLogin no
</span><span class='line'>StrictModes yes
</span><span class='line'>#MaxAuthTries 6
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>#RSAAuthentication yes
</span><span class='line'>PubkeyAuthentication yes
</span><span class='line'>#AuthorizedKeysFile .ssh/authorized_keys
</span><span class='line'>
</span><span class='line'>
</span><span class='line'># For this to work you will also need host keys in /etc/ssh/ssh_known_hosts
</span><span class='line'>#RhostsRSAAuthentication no
</span><span class='line'># similar for protocol version 2
</span><span class='line'>#HostbasedAuthentication no
</span><span class='line'># Change to yes if you don't trust ~/.ssh/known_hosts for
</span><span class='line'># RhostsRSAAuthentication and HostbasedAuthentication
</span><span class='line'>#IgnoreUserKnownHosts no
</span><span class='line'># Don't read the user's ~/.rhosts and ~/.shosts files
</span><span class='line'>#IgnoreRhosts yes
</span><span class='line'>
</span><span class='line'>
</span><span class='line'># To disable tunneled clear text passwords, change to no here!
</span><span class='line'>PasswordAuthentication no
</span><span class='line'>PermitEmptyPasswords no
</span><span class='line'>
</span><span class='line'>
</span><span class='line'># Change to no to disable s/key passwords
</span><span class='line'>ChallengeResponseAuthentication no
</span><span class='line'>
</span><span class='line'>
</span><span class='line'># Kerberos options
</span><span class='line'>#KerberosAuthentication no
</span><span class='line'>#KerberosOrLocalPasswd yes
</span><span class='line'>#KerberosTicketCleanup yes
</span><span class='line'>#KerberosGetAFSToken no
</span><span class='line'>
</span><span class='line'>
</span><span class='line'># GSSAPI options
</span><span class='line'>#GSSAPIAuthentication no
</span><span class='line'>#GSSAPICleanupCredentials yes
</span><span class='line'>
</span><span class='line'>
</span><span class='line'># Set this to 'yes' to enable PAM authentication, account processing,
</span><span class='line'># and session processing. If this is enabled, PAM authentication will
</span><span class='line'># be allowed through the ChallengeResponseAuthentication and
</span><span class='line'># PasswordAuthentication. Depending on your PAM configuration,
</span><span class='line'># PAM authentication via ChallengeResponseAuthentication may bypass
</span><span class='line'># the setting of "PermitRootLogin without-password".
</span><span class='line'># If you just want the PAM account and session checks to run without
</span><span class='line'># PAM authentication, then enable this but set PasswordAuthentication
</span><span class='line'># and ChallengeResponseAuthentication to 'no'.
</span><span class='line'>UsePAM yes
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>#AllowTcpForwarding yes
</span><span class='line'>#GatewayPorts no
</span><span class='line'>#X11Forwarding no
</span><span class='line'>#X11DisplayOffset 10
</span><span class='line'>#X11UseLocalhost yes
</span><span class='line'>#PrintMotd yes
</span><span class='line'>#PrintLastLog yes
</span><span class='line'>#TCPKeepAlive yes
</span><span class='line'>#UseLogin no
</span><span class='line'>UsePrivilegeSeparation yes
</span><span class='line'>#PermitUserEnvironment no
</span><span class='line'>#Compression delayed
</span><span class='line'>ClientAliveInterval 600
</span><span class='line'>ClientAliveCountMax 0
</span><span class='line'>#UseDNS yes
</span><span class='line'>#PidFile /var/run/sshd.pid
</span><span class='line'>#MaxStartups 10
</span><span class='line'>PermitTunnel no
</span><span class='line'>#ChrootDirectory none
</span><span class='line'>
</span><span class='line'>
</span><span class='line'># no default banner path
</span><span class='line'>#Banner none
</span><span class='line'>
</span><span class='line'>
</span><span class='line'># override default of no subsystems
</span><span class='line'>Subsystem sftp /usr/sbin/sftp-server
</span><span class='line'>
</span><span class='line'>
</span><span class='line'># Example of overriding settings on a per-user basis
</span><span class='line'>#Match User anoncvs
</span><span class='line'># X11Forwarding no
</span><span class='line'># AllowTcpForwarding no
</span><span class='line'># ForceCommand cvs server
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>AllowGroups rmt_acc</span></code></pre></td></tr></table></div></figure>


<h1>install sudo for AIX</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rpm -i sudo-for-aix.rpm</span></code></pre></td></tr></table></div></figure>


<h1>stop telnet/login/ftp/shell/exec service:</h1>

<p>don&rsquo;t start telnet if reboot:</p>

<p>comment the line starts with &lsquo;telnet&rsquo;/&lsquo;login&rsquo;/&lsquo;ftp&rsquo;/&lsquo;shell&rsquo;/&lsquo;exec&rsquo; in /etc/inetd.conf</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>stopsrc -t telnet</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[developing-on-blackberry]]></title>
    <link href="http://www.youth2009.org/www/blog/2014/09/05/developing-on-blackberry/"/>
    <updated>2014-09-05T21:58:07+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2014/09/05/developing-on-blackberry</id>
    <content type="html"><![CDATA[<h1>Create BlackBerry ID token</h1>

<p>here:
<strong> <a href="https://www.blackberry.com/SignedKeys/">https://www.blackberry.com/SignedKeys/</a> </strong></p>

<p>If you will develop an app on BlackBerry OS 10 or some new plateform, choose the first checkbox, and you will be requested your BlackBerry ID username and password, other choices I haven&rsquo;t tried. Then fill a storepass for the key, you can download a file like <code>bbidtoken.csk</code>, save this file to <code>~/Library/Research In Motion</code>, if you are on Windows or Linux, save this file to where website mentioned.</p>

<h1>Create developer certificate file</h1>

<p>developer certificate file is a file named author.p12</p>

<p>I have installed a WebWorks SDK, so I can access blackberry tools on <code>/Applications/BB10 WebWorks SDK 2.1.0.13/cordova-blackberry/bin/dependencies/bb-tools/bin</code>, you should change this path as your SDK type, the target file is <code>blackberry-keytool</code>.</p>

<p><code>blackberry-keytool -genkeypair -storepass &lt;keystore_pw&gt; -author &lt;YOUR_NAME&gt;</code></p>

<p>This will create the author.p12 file on the same directory described below:<code>~/Library/Research In Mothion</code></p>

<h1>Create debug token</h1>

<p><code>blackberry-debugtokenrequest -storepass &lt;KeystorePassword&gt; -devicepin &lt;YOUR_DEVICE_PIN&gt; ~/Library/Research In Motion/debug_token.bar</code></p>

<p>This will create debug token bar file on <code>~/Library/Research In Motion</code>, caution: debug token file must be a *.bar file.</p>

<h1>Install debug token on your device</h1>

<p>Enable your development mode on your device first (Settings > Security and Privacy > Development Mode)</p>

<p><code>blackberry-deploy -installDebugToken &lt;path to debug token&gt; -device &lt;DEVICE_IP_ADDRESS&gt; -password &lt;DEVICE_PIN&gt;</code></p>

<p>Your should get output like these:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Info: Sending request: INSTALL_DEBUG_TOKEN
</span><span class='line'>Info: Action: Install Debug Token
</span><span class='line'>Info: File size: 2607
</span><span class='line'>result::success</span></code></pre></td></tr></table></div></figure>


<p>Then your device development info has changed, &ldquo;Debug Token Installed&rdquo;</p>

<h1>deploy an hello world to your device</h1>

<p>I use WebWorks SDK, so I launched this app on Mac, and fill some info about project on <code>localhost:3123</code>, a web management for development. After created the app, choose &ldquo;Build&rdquo; on left hand, fill your device password and keystore password, choose BUILD &amp; INSTALL, you may get output like these:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[INFO]    Target Q10-2b1e42dc selected
</span><span class='line'>[INFO]    Generating debug token
</span><span class='line'>[INFO]    Debug token created.
</span><span class='line'>[INFO]    Deploying debug token to target "Q10-2b1e42dc"
</span><span class='line'>[INFO]    Sending request: INSTALL_DEBUG_TOKEN
</span><span class='line'>[INFO]    Action: Install Debug Token
</span><span class='line'>[INFO]    File size: 2605
</span><span class='line'>[INFO]    result::success
</span><span class='line'>[INFO]    Populating application source
</span><span class='line'>[INFO]    Parsing config.xml
</span><span class='line'>[INFO]    Generating output files
</span><span class='line'>[INFO]    Package created: /Users/dawncold/WebWorks Projects/Project1/platforms/blackberry10/build/simulator/bb10app.bar
</span><span class='line'>[INFO]    Package created: /Users/dawncold/WebWorks Projects/Project1/platforms/blackberry10/build/device/bb10app.bar
</span><span class='line'>[INFO]    BAR packaging complete
</span><span class='line'>[INFO]    Sending request: INSTALL_AND_LAUNCH
</span><span class='line'>[INFO]    Action: Install and Launch
</span><span class='line'>[INFO]    File size: 69497
</span><span class='line'>[INFO]    Installing Project1.testDev_Project1___c8537c58...
</span><span class='line'>[INFO]    Processing 69497 bytes
</span><span class='line'>[INFO]    Progress 100%...
</span><span class='line'>[INFO]    Progress 100%...
</span><span class='line'>[INFO]    actual_dname::Project1.testDev_Project1___c8537c58actual_id::testDev_Project1___c8537c58
</span><span class='line'>[INFO]    actual_version::0.0.1.1result::successLaunching Project1.testDev_Project1___c8537c58...
</span><span class='line'>[INFO]    result::19132657
</span><span class='line'>[INFO]    done</span></code></pre></td></tr></table></div></figure>


<p>Meanwhile, your app will be opened on your device!
<img src="http://pic.yupoo.com/dawncold0/E2fQtBuX/small.jpg" alt="webworks launch screen" /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[external disk with openwrt]]></title>
    <link href="http://www.youth2009.org/www/blog/2014/08/22/external-disk-with-openwrt/"/>
    <updated>2014-08-22T23:05:57+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2014/08/22/external-disk-with-openwrt</id>
    <content type="html"><![CDATA[<p>上次笔记本替换下来的硬盘闲在那里很久了，反正闲着没用，不如装点东西，比如监控的图片什么的，每分钟两张的速度拍，一个工作日，大约能有5G的数据，要是都传到七牛那么也就两天，免费的磁盘空间就满了，但绝大多数图片是没意义的，手动删的话，勤快些也行。</p>

<p>不过要是存到磁盘上的话，就无所谓了，500G的空间，怎么能等好几个月之后再考虑，程序员都是很懒很懒的。。。</p>

<p>磁盘是笔记本的2.5英寸STAT接口，需要一根USB2STAT的线，接到已经很疲劳的路由器上（703N改装版），路由器刷了OpenWrt。</p>

<p>登陆路由器后需要装几个软件，一是mount磁盘需要的，二是vsftpd，准备做成ftp供监控使用。把磁盘连接到路由器上而不是直接连到监控上的原因是：假如有人入侵，看到监控一定会破坏，有可能会把磁盘也带走，这样证据就木有了，而连接到路由器上的话，位置比较隐蔽，不容易察觉，会好一些，我就是这么邪恶。。。</p>

<p>对于mount磁盘需要的软件可能是：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>opkg update
</span><span class='line'>opkg install kmod-usb-storage block-mount kmod-fs-ext4</span></code></pre></td></tr></table></div></figure>


<p>可能不是必须的，但看了文档没怎么研究，反正装了这些能mount了，由于我就一块磁盘，直接mount到了/mnt中。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mount /dev/sda1 /mnt</span></code></pre></td></tr></table></div></figure>


<p>能用后需要把/mnt的owner改为<code>root:root</code>，权限755，在/mnt下创建ftp目录，owner是<code>ftp:ftp</code>，权限755。（ftp用户是装了vsftpd后创建的，所以你需要先装一下vsftpd）</p>

<p>vsftpd的配置：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>background=YES
</span><span class='line'>listen=YES
</span><span class='line'>anonymous_enable=NO
</span><span class='line'>chroot_local_user=YES
</span><span class='line'>local_enable=YES
</span><span class='line'>local_root=/mnt
</span><span class='line'>write_enable=YES
</span><span class='line'>local_umask=022
</span><span class='line'>check_shell=NO</span></code></pre></td></tr></table></div></figure>


<p>研究了一段时间这些配置，第一个建议测试时候用NO，正式开始用就YES，否则会让路由器一直卡在启动vsftpd这里，网路会不可用。比较关键的是<code>local_root</code>，登陆后用户的root目录会在这里，但不能在里面的ftp中，原因和chroot有关，刚刚在/mnt中创建的ftp目录就是ftp用户登陆上去后可操作的地方，所有操作都需要在ftp目录下进行。其他配置具体不详述，具体含义可以看官方的man page，感觉前七行是比较重要的。</p>

<p>ftp搭建过程中出现can not create file和permission方面的问题请检查local_root和里面目录的权限。另外vsftpd有本地用户和匿名用户、虚拟用户等不同的配置，我用的是本地用户的方法，其他两种，除了虚拟用户配置看起来比较麻烦我没有尝试外，匿名用户也配置过，不过后来一直卡在can not create file这里，没再尝试，应该还是权限问题。</p>

<p>下面是OpenWrt启动mount的设置，在<code>/etc/config/fstab</code>中加入：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>config mount
</span><span class='line'>  option target /mnt
</span><span class='line'>  option device /dev/sda1
</span><span class='line'>  option fstype ext4
</span><span class='line'>  option options rw,sync
</span><span class='line'>  option enabled 1
</span><span class='line'>  option enabled_fsck 0</span></code></pre></td></tr></table></div></figure>


<p>具体的/mnt和/dev/sda1、ext4根据你的情况做修改，enabled为1就是启动时加载。</p>

<p>没想到的是装了vsftpd，又挂了个磁盘，小路由器还能撑得住，也许还没开始用，等往里写文件的时候再看看。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[role in postgresql]]></title>
    <link href="http://www.youth2009.org/www/blog/2014/08/14/role-in-postgresql/"/>
    <updated>2014-08-14T22:08:20+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2014/08/14/role-in-postgresql</id>
    <content type="html"><![CDATA[<p>In PostgreSQL versions before 8.1, users and groups were distinct kinds of entities, but now only role, it is user or group or both.</p>

<p>if you create a role using “CREATE ROLE r1”, r1 is not a user, only a generic role, it is likely a group, you can not find it in pg_user, only in pg_roles table, but if you grant LOGIN privilege to r1, it will be appear in pg_user table.</p>

<p>After installed postgresql cluster, you need execute initdb, and it will create a default role with superuser privilege, costomarily this role(user) named postgres</p>

<p>Role’s attributes: login, superuser, database creation, role creation, initiating replication, password</p>

<p>CREATE USER r1 == CREATE ROLE r1 LOGIN</p>

<p>Tip: It is good practice to create a role that has the CREATEDB and CREATEROLE privileges, but is not a superuser, and then use this role for all routine management of databases and roles. This approach avoids the dangers of operating as a superuser for tasks that do not really require it.</p>

<p>examples:</p>

<p>CREATE ROLE joe LOGIN INHERIT;
CREATE ROLE admin NOINHERIT;
CREATE ROLE wheel NOINHERIT;
GRANT admin TO joe;
GRANT wheel TO admin;</p>

<p>joe can access admin privilege by using “SET ROLE admin”, or if joe has the INHERIT, joe can access privilege directly from admin, if joe want to use these privileges, joe must “SET ROLE admin”. Joe can not access privilege from wheel, because admin has the NOINHERIT, admin can not get these privileges, so as joe.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[else clause in python loop]]></title>
    <link href="http://www.youth2009.org/www/blog/2014/08/14/else-clause-in-python-loop/"/>
    <updated>2014-08-14T22:07:09+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2014/08/14/else-clause-in-python-loop</id>
    <content type="html"><![CDATA[<p>both in while and for loop, if in loop body, no break, no return, no exception is raised, statements in else block will be executed.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[]:</span>
</span><span class='line'>     <span class="k">print</span> <span class="n">x</span>
</span><span class='line'><span class="k">else</span><span class="p">:</span>
</span><span class='line'>     <span class="k">print</span> <span class="err">‘</span><span class="n">xxx</span><span class="err">’</span>
</span></code></pre></td></tr></table></div></figure>


<p>this example will print ‘xxx’, even nothing in list and this loop is not executed.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iptables -A INPUT -i eth0 -p tcp -m tcp --dport 80 -j ACCEPT]]></title>
    <link href="http://www.youth2009.org/www/blog/2014/08/14/a-input-i-eth0-p-tcp-m-tcp-dport-80-j-accept/"/>
    <updated>2014-08-14T22:05:46+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2014/08/14/a-input-i-eth0-p-tcp-m-tcp-dport-80-j-accept</id>
    <content type="html"><![CDATA[<p>what’s the agreement of -m?</p>

<p>not tcp, it’s “tcp &mdash;dport 80”</p>

<p>-m matches, using a somewhat complicated &ldquo;module matching&rdquo; mechanism.  There are a bunch of pretty cool modules in iptables, for example &ldquo;recent&rdquo;.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Absolute Positioning Inside Relative Positioning]]></title>
    <link href="http://www.youth2009.org/www/blog/2014/08/14/absolute-positioning-inside-relative-positioning/"/>
    <updated>2014-08-14T22:00:36+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2014/08/14/absolute-positioning-inside-relative-positioning</id>
    <content type="html"><![CDATA[<p>if you want a div with absolute position relative its parent, not body, the parent div must be relative position.</p>

<p>see details <a href="http://css-tricks.com/absolute-positioning-inside-relative-positioning/">http://css-tricks.com/absolute-positioning-inside-relative-positioning/</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iptables MASQUERADE]]></title>
    <link href="http://www.youth2009.org/www/blog/2014/06/13/iptables-MASQUERADE/"/>
    <updated>2014-06-13T20:50:30+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2014/06/13/iptables-MASQUERADE</id>
    <content type="html"><![CDATA[<p>If you need private hosts communicate with external network, maybe some LXC contaners want to using apt-get, you need add a iptables rule like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>iptables -t nat -A POSTROUTING -s 10.24.1.0/24 ! -d 10.24.1.0/24 -j MASQUERADE</span></code></pre></td></tr></table></div></figure>


<p>This rule allows network traffic from 10.24.1.x, and destination is not 10.24.1.x, maybe it wants to communicating with 10.24.2.x, but that doesn&rsquo;t cover in this post, we assumed it want to communicating with Google, the host has an external ip like 200.200.200.200, iptables can convert IP from 10.24.1.x to IP from 200.200.200.200, like the host request Google.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[postgresql indexes]]></title>
    <link href="http://www.youth2009.org/www/blog/2014/06/01/postgresql-indexes/"/>
    <updated>2014-06-01T10:18:27+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2014/06/01/postgresql-indexes</id>
    <content type="html"><![CDATA[<h1>Introduction</h1>

<p>Indexes will speed up your read(SELECT) and write(INSERT, UPDATE, DELETE) operation on a table, but they should by removed when a query seldom or never used. Create a bit table&rsquo;s index will spend lot of time. By default, PostgreSQL allows reads (SELECT statements) to occur on the table in parallel with index creation, but writes (INSERT, UPDATE, DELETE) are blocked until the index build is finished. In production environments this is often unacceptable. It is possible to allow writes to occur in parallel with index creation, but there are several caveats to be aware of — for more information see <a href="http://www.postgresql.org/docs/9.3/static/sql-createindex.html#SQL-CREATEINDEX-CONCURRENTLY">Building Indexes Concurrently</a>.</p>

<h1>Index Types</h1>

<p>PostgreSQL provides several index types: B-tree, Hash, GiST, SP-GiST and GIN. By default, the CREATE INDEX command creates B-tree indexes, which fit the most common situations.</p>

<h1>Multicolumn index</h1>

<p>Currently, only the B-tree, GiST and GIN index types support multicolumn indexes. Up to 32 columns can be specified. (This limit can be altered when building PostgreSQL; see the file pg_config_manual.h.)</p>

<p>if your frequently query is like this: <code>SELECT name FROM test2 WHERE major = constant AND minor = constant;</code>, your need create an index on table test2 with <code>major</code>, <code>minor</code> columns: <code>CREATE INDEX test2_mm_idx ON test2 (major, minor);</code></p>

<p>The order is important in multicolumn index:</p>

<blockquote><p>A multicolumn B-tree index can be used with query conditions that involve any subset of the index&rsquo;s columns, but the index is most efficient when there are constraints on the leading (leftmost) columns. The exact rule is that equality constraints on leading columns, plus any inequality constraints on the first column that does not have an equality constraint, will be used to limit the portion of the index that is scanned. Constraints on columns to the right of these columns are checked in the index, so they save visits to the table proper, but they do not reduce the portion of the index that has to be scanned. For example, given an index on (a, b, c) and a query condition WHERE a = 5 AND b >= 42 AND c &lt; 77, the index would have to be scanned from the first entry with a = 5 and b = 42 up through the last entry with a = 5. Index entries with c >= 77 would be skipped, but they&rsquo;d still have to be scanned through. This index could in principle be used for queries that have constraints on b and/or c with no constraint on a — but the entire index would have to be scanned, so in most cases the planner would prefer a sequential table scan over using the index.</p></blockquote>

<h1>Order By</h1>

<p>By default, B-tree indexes store their entries in ascending order with nulls last.</p>

<h1>Combining Multiple Indexes</h1>

<p>little difficult just trade off to decide which indexes to provide. Sometimes multicolumn indexes are best, but sometimes it&rsquo;s better to create separate indexes and rely on the index-combination feature.</p>

<h1>Index on Expressions</h1>

<p>This kind of index, not a specific column, it&rsquo;s an expression: <code>CREATE INDEX people_names ON people ((first_name || ' ' || last_name));</code></p>

<h1>Partial Index</h1>

<p><code>CREATE INDEX idx_xxx ON table(name) WHERE NOT deleted</code> this index only enables to rows which deleted is <code>TRUE</code></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[python-main-py]]></title>
    <link href="http://www.youth2009.org/www/blog/2014/05/30/python-main-py/"/>
    <updated>2014-05-30T21:05:20+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2014/05/30/python-main-py</id>
    <content type="html"><![CDATA[<p>python的<code>__main__.py</code>文件，通常，一个package下有一个<code>__init__.py</code>文件标识这是package，同样可以有一个<code>__main__.py</code>文件，有了后你就可以这样运行一个脚本：<code>python script_dir</code>或者把这个dir打包成zip，可以使用<code>python zipball.zip</code>来执行，python会执行<code>__main__.py</code>中的语句。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[disable-keyboard-on-ubuntu]]></title>
    <link href="http://www.youth2009.org/www/blog/2014/05/30/disable-keyboard-on-ubuntu/"/>
    <updated>2014-05-30T20:54:45+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2014/05/30/disable-keyboard-on-ubuntu</id>
    <content type="html"><![CDATA[<p>有时候不接外置显示器的时候，喜欢把键盘压在笔记本键盘上方使用，但如果不禁用内置键盘的话就会有误操作的风险，所以这样做，利用ubuntu中的xinput</p>

<p>查看设备使用<code>xinput list</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>⎡ Virtual core pointer                      <span class="nv">id</span><span class="o">=</span>2    <span class="o">[</span>master pointer  <span class="o">(</span>3<span class="o">)]</span>
</span><span class='line'>⎜   ↳ Virtual core XTEST pointer                <span class="nv">id</span><span class="o">=</span>4    <span class="o">[</span>slave  pointer  <span class="o">(</span>2<span class="o">)]</span>
</span><span class='line'>⎜   ↳ SynPS/2 Synaptics TouchPad                <span class="nv">id</span><span class="o">=</span>11   <span class="o">[</span>slave  pointer  <span class="o">(</span>2<span class="o">)]</span>
</span><span class='line'>⎜   ↳ Logitech USB-PS/2 Optical Mouse           <span class="nv">id</span><span class="o">=</span>12   <span class="o">[</span>slave  pointer  <span class="o">(</span>2<span class="o">)]</span>
</span><span class='line'>⎜   ↳ Logitech Unifying Device. Wireless PID:4004   <span class="nv">id</span><span class="o">=</span>13   <span class="o">[</span>slave  pointer  <span class="o">(</span>2<span class="o">)]</span>
</span><span class='line'>⎣ Virtual core keyboard                     <span class="nv">id</span><span class="o">=</span>3    <span class="o">[</span>master keyboard <span class="o">(</span>2<span class="o">)]</span>
</span><span class='line'>    ↳ Virtual core XTEST keyboard               <span class="nv">id</span><span class="o">=</span>5    <span class="o">[</span>slave  keyboard <span class="o">(</span>3<span class="o">)]</span>
</span><span class='line'>    ↳ Power Button                              <span class="nv">id</span><span class="o">=</span>6    <span class="o">[</span>slave  keyboard <span class="o">(</span>3<span class="o">)]</span>
</span><span class='line'>    ↳ Video Bus                                 <span class="nv">id</span><span class="o">=</span>7    <span class="o">[</span>slave  keyboard <span class="o">(</span>3<span class="o">)]</span>
</span><span class='line'>    ↳ Sleep Button                              <span class="nv">id</span><span class="o">=</span>8    <span class="o">[</span>slave  keyboard <span class="o">(</span>3<span class="o">)]</span>
</span><span class='line'>    ↳ Acer CrystalEye webcam                    <span class="nv">id</span><span class="o">=</span>9    <span class="o">[</span>slave  keyboard <span class="o">(</span>3<span class="o">)]</span>
</span><span class='line'>    ↳ AT Translated Set 2 keyboard              <span class="nv">id</span><span class="o">=</span>10   <span class="o">[</span>slave  keyboard <span class="o">(</span>3<span class="o">)]</span>
</span></code></pre></td></tr></table></div></figure>


<p>找到内置键盘，我这里是那个叫&#8221;AT Translated Set 2 keyboard&#8221;的，id是10，禁用使用：<code>xinput float 10</code></p>

<p>如果再启用使用<code>xinput reattach 10 3</code>，3标识这个设备的master的id，从list的结果很容易看到从属关系。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[log2n和log3n]]></title>
    <link href="http://www.youth2009.org/www/blog/2014/05/30/log2n-log3n/"/>
    <updated>2014-05-30T20:45:44+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2014/05/30/log2n-log3n</id>
    <content type="html"><![CDATA[<p>merge sort的时间复杂度，log2n，曾经在算法书上看到过，相应的，merge sort也可以三分，复杂度变成log3n，好像还不错，但差多少呢？</p>

<p>log3n=log2n/log2(3)，也就是只差了1/log2(3)对于看起来还更大。一般算法复杂度是log2n表示就是这个原因，loga(n)和log2n差不了太多，都是常数级别的差距，而且在复杂度分析的时候都会忽略常数，所以就简记为log2n复杂度了：）</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[md5 digest]]></title>
    <link href="http://www.youth2009.org/www/blog/2014/05/30/md5-digest/"/>
    <updated>2014-05-30T20:29:58+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2014/05/30/md5-digest</id>
    <content type="html"><![CDATA[<p>对于一个字符串做md5，例如：&#8221;<order></order>123456&#8221;做完md5后，比较常见的结果是：<code>2e08539049ac0f6b5b4377ec20145c06</code>，即十六进制的表示形式，长度一般是32位，有人也用16位的表示，就是把32位的字符串前后各去掉8位后的结果，但不多见。还有就是用md5的digest值，这是一个16字节的字符串，不容易看，但可以转换成ascii后观察，比如上面的digest就是：<code>[46, 8, 83, 144, 73, 172, 15, 107, 91, 67, 119, 236, 32, 20, 92, 6]</code>， 如果你还看不清的话，可以考虑把这些ascii转成十六进制再看看：<code>['2e', '08', '53', '90', '49', 'ac', '0f', '6b', '5b', '43', '77', 'ec', '20', '14', '5c', '06']</code>，是不是很熟悉了，对就是一开始那个32位长的字符串。</p>

<p>在对某通的接口开发中遇到对发送数据校验，文档中说的是对数据进行md5再做base64，通常就是把那个32位长的字符串做base64，但怎么也对不上，后来再研究发现其实是用digest的结果做base64，太坑人了是吧，文档这个东西，能写详细就写详细点，没坏处。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[dive-into-tornado]]></title>
    <link href="http://www.youth2009.org/www/blog/2014/03/27/dive-into-tornado/"/>
    <updated>2014-03-27T21:22:58+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2014/03/27/dive-into-tornado</id>
    <content type="html"><![CDATA[<p>早就有这样的计划，要深入了解自己在用的工具，veil算一个，tornado算一个，flask算一个……当然还有好多，总得一个个看一番，好在这些库都写得足够简单，不至于一下子看不懂，而且借助pycharm这样优秀的工具，一步步跟踪代码也给深入理解框架极大的帮助，所以，开始吧。（也好久都没更新过技术博客的内容了）</p>

<p>终于可以再让Mac发挥发挥余热了，pycharm用的社区版，估计对于学习够用了。tornado升级到了稳定的3.2版，也是目前的最新版，先慢慢研读官方的文档，再慢慢看完api。</p>

<p>在写hello，world例子的时候，处理GET我直接就下意识返回了想要的字符串，没想到运行起来是500 error，仔细一看原来官方的例子中处理GET是要调用<code>self.write('xxx')</code>，然后我就看了下self.write做了什么，self是我定义的class，但这个class继承自tornado.web.RequestHandler, 于是看tornado.web.RequestHandler的write做什么，write的参数叫chunk，并不是简单的叫str之类的东西，也就是说不限于str，有可能是些别的东西，比如注释中说如果你write了一个dict，tornado会转换成JSON，并且把Content-Type给你设置好，现在的veil也支持了这个优秀特性。还提到了list不会被转换成JSON格式，因为一个漏洞（坑），具体看<a href="http://haacked.com/archive/2008/11/20/anatomy-of-a-subtle-json-vulnerability.aspx/">这里</a>，简单讲，就是用script的src指向一个网站需要登陆后才能访问的地址，因为你如果登陆过的话，cookie信息会随之发送到这个地址，此时如果你去了一个邪恶的网站，他里面有些脚本，引用刚刚提到的你需要登陆的网址，你浏览器会把你的一些信息带上，请求这个地址，这个地址会返回一些你的个人资料，比如是用JSON的array回给你，但邪恶网站把javascript array的constructor改写了，你拿到JSON的array会被自动转成js array，这样邪恶网站会收集到你的信息，然后再发送回自己一个接受数据的接口就可以了。避免方法就是：返回JSON的时候用对象方式；这种关键信息用POST提交，script标签只会发送GET请求；现代高级浏览器都不会有问题，大可放心。转换成了byte string（就是str）放入chunk_buffer，一起写到output。</p>

<p>我们的handler很简单，实现了get方法，然后write了一个字符串，但后来呢？或许应该从另一条路看起——从url被映射到handler看起。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[return-value-in-jquery-json-datatype]]></title>
    <link href="http://www.youth2009.org/www/blog/2014/01/23/return-value-in-jquery-json-datatype/"/>
    <updated>2014-01-23T18:57:21+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2014/01/23/return-value-in-jquery-json-datatype</id>
    <content type="html"><![CDATA[<p>向api server发送请求做一件事的时候，比如修改密码，server做完后没有返回值，response code是200。这在原来的时候没问题，“原来”是指ajax的dataType未指定的时候，jQuery会自己猜测用什么，但这次指定了server的response是json，所以，即便是看到200 code也未能调用OnSuccess，空返回值对于json是不合法的，于是返回一个什么东西就好，当然要先to_json再返回。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[nginx-and-dependences]]></title>
    <link href="http://www.youth2009.org/www/blog/2014/01/16/nginx-and-dependences/"/>
    <updated>2014-01-16T18:46:33+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2014/01/16/nginx-and-dependences</id>
    <content type="html"><![CDATA[<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>wget ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/pcre-8.34.tar.gz
</span><span class='line'>wget http://www.openssl.org/source/openssl-1.0.1f.tar.gz
</span><span class='line'>wget http://nginx.org/download/nginx-1.5.8.tar.gz
</span></code></pre></td></tr></table></div></figure>


<p>default install pcre and openssl</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>nginx configure
</span><span class='line'>+gzip
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Configuration summary
</span><span class='line'>  + using system PCRE library
</span><span class='line'>  + OpenSSL library is not used
</span><span class='line'>  + md5: using system crypto library
</span><span class='line'>  + sha1: using system crypto library
</span><span class='line'>  + using system zlib library
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[lxml-and-dependences]]></title>
    <link href="http://www.youth2009.org/www/blog/2014/01/16/lxml-and-dependences/"/>
    <updated>2014-01-16T18:31:09+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2014/01/16/lxml-and-dependences</id>
    <content type="html"><![CDATA[<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo apt-get install libxml2-dev
</span><span class='line'>sudo apt-get install libxslt1-dev
</span><span class='line'>sudo apt-get install python-dev  （if Python.h: No file or dir..）
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[daemon-in-nginx]]></title>
    <link href="http://www.youth2009.org/www/blog/2014/01/06/daemon-in-nginx/"/>
    <updated>2014-01-06T21:57:39+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2014/01/06/daemon-in-nginx</id>
    <content type="html"><![CDATA[<p>最近要把bnly重新运行起来，前两天整理了cli版本的程序，放到<a href="GitHub">https://github.com/dawncold/bnly-cli</a>，另一个web版的放到了bitbucket上的私有仓库，准备做部署的时候用，没想到bitbucket最近没有被kill，难道放开了？</p>

<p>用supervisor做进程管理的时候被nginx坑了，由于nginx的配置很强大，现在还处在搭建环境的初期，很多配置写不完整，导致了nginx总是在频繁启动，log中看到的是80端口已经被占用。。。找了半天只有nginx占着80，而且又不会开多个nginx（supervisor的配置中没有明确说开多个程序，默认一个），搜了挺长时间都没有结果。</p>

<p>突然想到了daemon。</p>

<p>nginx的文档建议生产环境应该off，但这个和我遇到的问题无关。默认daemon开了，supervisor运行后会认为nginx退出了，再启动一个，其实上一个已经启动成功，所以就总看到80端口被占用，于是在nginx的配置上加<code>deamon off</code>即可。</p>

<p>是不是很坑？</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Object.keys-and-JSON-in-IE6]]></title>
    <link href="http://www.youth2009.org/www/blog/2013/12/08/object-dot-keys-and-json-in-ie6/"/>
    <updated>2013-12-08T14:52:12+08:00</updated>
    <id>http://www.youth2009.org/www/blog/2013/12/08/object-dot-keys-and-json-in-ie6</id>
    <content type="html"><![CDATA[<p>下单页面用到了js中的JSON和Object.keys，都是坑。</p>

<p>JSON虽然是build-in的JSON parser和stringify方法，但IE6，7，8(Q)都是无法使用的，如果用jQuery的话，可以用jQuery的parseJSON来解析，但stringify的话需要依赖第三方库或者自己实现，我用了JSON3.js这个库。首选build-in的parse和stringify方法，如果没有就实现。github地址：<a href="https://github.com/bestiejs/json3">https://github.com/bestiejs/json3</a></p>

<p>同样的Object.keys()因为不能在IE9下使用，因为要取一个Object的keys数量，有的时候是用Object的keys列表，所以以后为了兼容，就只能：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">keys</span> <span class="o">=</span> <span class="p">[];</span>
</span><span class='line'><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">p</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">p</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">keys</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">p</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
</feed>
